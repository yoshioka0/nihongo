function _0x4841() {
    const _0x55619e = [
        '8j+BNcbszwnVBM5Ly3rLzcaOqxr0zw1WDca',
        'rxjYB3iGBg9HzgLUzYbJAgf0igXPC3q6',
        'C2v0uhjVCgvYDhK',
        '8j+sRca',
        'yMX1CI1ZBgLKzxi',
        'BM9YBwfS',
        'qxjLihLVDsbZDxjLihLVDsb3yw50ihrVigrLBgv0zsb0AgLZig1LC3nHz2u/',
        'BgvHDMvsB29T',
        'Dg9tDhjPBMC',
        '4PQG77IpifjLy29UBMvJDgLVBIbgywLSzwq',
        'ue9tva',
        'nZyYnufQqKDzrG',
        'y2HHDc13Aw5KB3C',
        't2zMBgLUzq',
        '8j+uTcbtB2nRzxqGDw5KzwzPBMvKoIbmAwTLBhKGzhvLihrVihnVy2TLDcbPBML0AwfSAxnHDgLVBIbHC3LUy2HYB25VDxm',
        'Dg9mB2nHBgveyxrLu3rYAw5N',
        'C2vUze1LC3nHz2u',
        'ntG3nevOuhDnrq',
        'rMfPBgvKihrVigrLBgv0zsbJAgf0igHPC3rVCNK6',
        'rxjYB3iGDxbSB2fKAw5NigLTywDLoG',
        'BNvTzxjPyW',
        'pgKGy2XHC3m9iMzHlxnVBgLKigzHlxrYyxnOiJ48l2K+',
        'C3bHBG',
        'B3bHy2L0Eq',
        'z2v0sxrLBq',
        'BwvZC2fNzq',
        'qMvHCMvYia',
        'yMX1CI1IDg4',
        'BwvZC2fNzs1PBNb1Da',
        'y29UBMvJDf9LCNjVCG',
        'C2v0sxrLBq',
        'DxnLCKLK',
        'AM9PBG',
        'C2vZC2LVBI1LEhbPCMvK',
        'ywrK',
        'yMXVy2STyNv0Dg9U',
        'zMXLEa',
        'pgrPDIbJBgfZCZ0Iy2HHDc1TzxnZywDLCYi+pc9KAxy+',
        'C2vSzG',
        'CgXHEq',
        'zg9JDw1LBNrfBgvTzw50',
        'zNjVBq',
        'lM1LC3nHz2uUC2vSzIaUCMvHzc1YzwnLAxb0',
        '8j+uTpcFN6lWN5+GieXVywrLzcbdAgf0DgvKifvZzxjZig1HDgnOAw5Nihf1zxj5',
        'D2fSBhbHCgvYtw9KywW',
        'i2nOyxqTBgLZDa',
        'y2vUDgvY',
        'y2HHDhrLzfvZzxjZ',
        '8j+BNcbdB25Uzwn0zwq',
        'BxLHDMf0yxi',
        'Dg9mB2nHBgvuAw1Lu3rYAw5N',
        'r0vu',
        'y2fUy2vSlxbYzxzPzxC',
        'l2fWAs9JAgf0CY9JAgf0DgvKlxvZzxjZ',
        'y29UDgfPBNm',
        'pha+rxjYB3iGBg9HzgLUzYbTzxnZywDLCY4GugXLyxnLihrYEsbHz2fPBIbSyxrLCI48l3a+',
        'vxnLCIbPCYbcDxn5',
        'zw1VAMKTyNv0Dg9U',
        'Aw5WDxq',
        'l2fWAs9JAgf0CY9TyxjRlxjLywq',
        'Dw5IBg9JAY11C2vY',
        'zw1PDa',
        'rxjYB3iGy2HLy2TPBMCGDxnLCIbHDMfPBgfIAwXPDhK6',
        'C2vHCMnOlxvZzxjZ',
        'Bw9Yzs1IDg4',
        '4PYfienOyxqGAxmGywXYzwfKEsb1Ccb0BYbKyxrLihDPDgGG',
        'y2HHBMDL',
        '8j+BNcbtB2nRzxqGy29UBMvJDgvKihrVihrOzsbZzxj2zxiGD2L0AcbjrdO',
        'C2vZC2LVBI1Hy3rPDMu',
        'uMvTB3zLzcbJB3jYDxb0zwqGy2HHDcbJywnOzsbMB3iGDxnLCIa',
        'y2HHDejSDxi',
        'y2f0y2G',
        '8j+tOsbgzxrJAgLUzYbdAgf0igHPC3rVCNKGzNjVBsbZzxj2zxi',
        'zw5JCNLWDgLVBKTLEq',
        'y2HHDc1SAxn0',
        'zgvJCNLWDa',
        'ls12Aa',
        'C3rYAw5N',
        'qxjLihLVDsbZDxjLihLVDsb3yw50ihrVia',
        'C3rYAw5NAwz5',
        'rxjYB3iGBwfYA2LUzYbTzxnZywDLCYbHCYbYzwfKoG',
        'rNvUy3rPB24GDw5HDMfPBgfIBguHie1LC3nHz2uGBM90igrLBgv0zwqGAxrZigP1C3qGysbKzw1VlG',
        'Aw1Hz2u',
        'yMXVy2S',
        'q2HHDcbOAxn0B3j5igrLBgv0zwqGC3vJy2vZC2z1BgX5',
        'DMLZAwjPBgL0EwnOyw5Nzq',
        'CMf3',
        'yxbWBgLJyxrPB24VANnVBG',
        'z2v0rNvSBfLLyxi',
        'l25PAg9Uz28VBwvKAweVBM90AwzPy2f0Aw9UlM1WmW',
        'A2v5',
        'DhLWzq',
        'Dg9eyxrLu3rYAw5N',
        'Aw1N',
        'y3nZvgv4Da',
        'BwfW',
        'rMfPBgvKihrVig1HCMSGBwvZC2fNzxmGyxmGCMvHzdO',
        'q2HHDcbJywnOzsbJBgvHCMvKigzVCIb1C2vYia',
        'DMfSDwu',
        'lMnOyxqTy29UDgfPBMvY',
        'zgL2',
        'twvZC2fNzxmGBwfYA2vKigfZihjLywq6',
        'x2LK',
        'sM9PBMvKihjVB206ia',
        'CMvJB25Uzwn0',
        'Aw5Uzxjive1m',
        'Aw5JBhvKzxm',
        'pha+tM8GDxnLCNmGzM91BMqGBwf0y2HPBMCGEw91CIbXDwvYEtWVCd4',
        'D2fYBG',
        'C2vUzgvY',
        'C2vUzc1IDxr0B24',
        'zgf0yxnLDa',
        'Aw1Hz2vvCMW',
        '4P2miezHAwXLzcb0BYbYzwzYzxnOignOyxqUifbSzwfZzsb0CNKGywDHAw4U',
        'ChvZAfn0yxrL',
        'CMvJzwL2zxi',
        'lMjHy2STyNrU',
        'rxjYB3iGyMXVy2TPBMCGDxnLCJO',
        'y2HHDf8',
        'rgvJCNLWDgLVBIbMywLSzwq6',
        'y2HHDeHPC3rVCNLezwXLDgvK',
        'ls1IBhvYlxzHBhvL',
        'z2v0tw9UDgG',
        'vw5IBg9JAW',
        'B25JBgLJAW',
        'yMfJA2DYB3vUzfnPEMu',
        'DgLTzxn0yw1W',
        'Bg9JyxrPB24',
        'lMnOyxqTD2LUzg93',
        'B25SB2fK',
        'z2v0',
        'ywXS',
        'y2XHC3nmAxn0',
        'y292zxi',
        '8j+KR/cFPk/WN6sV',
        'C2vHCMnOugfYyw1Z',
        'DxnLCM5HBwu',
        'sfruucbLCNjVCIeGu3rHDhvZoIa',
        'C3r5Bgu',
        'yxbWzw5Kq2HPBgq',
        'CMvHzc1YzwnLAxb0',
        'rxjYB3iGC2vUzgLUzYbTzxnZywDLoG',
        'pgGXpLnLC3nPB24GrxHWAxjLzcWGuMvMCMvZAcb0AguGCgfNzs48l2GXpGOjcqKjcqKjcqKjcqKjpgLTzYbZDhLSzt0IAgvPz2H0oJuWChG7ihDPzhrOoJuWChG7iIbZCMm9iI9UAwHVBMDVl2LTzY9Py29UlNbUzYiGlZ4j',
        'y29SB3i',
        'qwnJzxnZigrLBMLLzc4',
        'y2HHDc11C2vY',
        'Aw1Hz2uTBg9HzgvY',
        'Dhj1zq',
        'quvtluDdtq',
        'y2XPy2S',
        'mtf2q2viAMq',
        '4PQG77IpifnVBwuGy2HHDhmGzMfPBgvKihrVigXVywqGzhvLihrVigrLy3j5ChrPB24GzxjYB3jZlG',
        'pha+tM8GDxnLCNmGzM91BMqGBwf0y2HPBMCGEw91CIbXDwvYEs48l3a+',
        'zgLZy29UBMvJDa',
        '4PQG77IpierPC2nVBM5Ly3rLza',
        'tM8GDg9Rzw4GzM91BMq',
        'AhjLzG',
        'ANnVBG',
        'CxvLCNLtzwXLy3rVCG',
        'C29JA2v0lxn0yxr1CW',
        'CMvTB3zLsxrLBq',
        'C2HVDW',
        'vxnLCIbjrcbVCIbvC2vYBMfTzsbPCYbTAxnZAw5NlIbtA2LWCgLUzY4',
        'BwvZC2fNzxnszwfK',
        'zMXVB3i',
        'tgfZDcbtzwvUoIbzzxn0zxjKyxKSia',
        'l2fWAs9JAgf0CY8',
        'y2HHDc1PBwfNzq',
        'l2fWAs9JAgf0CY9ZyxzLlwnOyxr0zwqTDxnLCG',
        'zgvSzxrL',
        'pha+tM8GBwvZC2fNzxmGEwv0lJWVCd4',
        'zgf0yq',
        'B25WB3bZDgf0zq',
        'Aw5UzxjizwLNAhq',
        'z2v0rgf0zq',
        'sw52ywXPzcbYzxnWB25ZzsbMCM9TihnLCNzLCG',
        'sw1Hz2uGDxbSB2fKigzHAwXLzce',
        'mZGWntLWyu5hwKG',
        'DhjHBNnPDgLVBG',
        'zxHWB3j0s2v5',
        'y3vYCMvUDfrPBwu',
        'rgvJCNLWDgLVBIbMywLSzwq',
        'u2vZC2LVBIbfEhbPCMvK',
        'zgvSzxrLlwj1DhrVBG',
        'AxnszwfK',
        'Bg9N',
        'z2v0uMfUzg9TvMfSDwvZ',
        'ywrKrxzLBNrmAxn0zw5LCG',
        'Dgv4DenVBNrLBNq',
        'CgfYC2u',
        'DxnLCK9UBgLUzq',
        'y2HHDfDHBgXWyxbLCG',
        'mJGWnJe4otbvCePnywy',
        'yMfJA2DYB3vUzfbVC2L0Aw9U',
        're9nq29UDgvUDeXVywrLza',
        'AxncBg9JA2vK',
        '4PYfienOyxqGq2fJAguGtg9HzgvKifn1y2nLC3nMDwXSEs4',
        'C2HVDY1JAgf0',
        'B3bHy2L0EsaWlJnZigvHC2uTAw4TB3v0',
        'rxjYB3i6ia',
        'l2fWAs9JAgf0CY9HDMfPBgfIAwXPDhKV',
        'mI1KAwDPDa',
        'BMf0AxzL',
        'zw5JB2rL',
        'DhLWAw5N',
        'B2zMBgLUzq',
        'rxjYB3iGBg9HzgLUzYbJAgf0ig1LC3nHz2vZoG',
        'C2nYB2XSsgvPz2H0',
        'zxjYB3i',
        'yNvZEq',
        'pha+u2vHCMnOihf1zxj5igXLBMD0AcbTDxn0igjLid49idm8l3a+',
        'y29U',
        'odK0z0DvBwT2',
        'mtiXotzODgrJr3K',
        'z3jLzw4',
        'C2v0',
        'Dg9mB3DLCKnHC2u',
        '4PQHifvZAw5NienHy2HLzcbdAgf0igzVCIa',
        'yMfJA2DYB3vUza',
        'C3rHCNrZv2L0Aa',
        'vxnLCIbPCYbuExbPBMCGlIaUic4',
        'ihjLywqGBwvZC2fNzxmGAw4Gy2HHDca',
        'ntq0s1rxCvnl',
        'DgfYz2v0',
        'y3jLyxrLrwXLBwvUDa',
        '8j+BNcbszwnVBM5Ly3rLzcb0BYbZzxj2zxiSigf0DgvTChqGiW',
        'B25SAw5L',
        'zgLZ',
        'rxjYB3i6iezPBguGC2L6zsbLEgnLzwrLzcbVCIb0B28GBwfUEsbYzxf1zxn0CW',
        'z2v0rwXLBwvUDej5swq',
        'BM9Uzq',
        'DhjPBq',
        '4PQG77IpienVBM5Ly3rPB24GzMfPBgvKoG',
        'zw4Tvvm',
        'zw1VAMKTCgLJA2vY',
        '8j+uHcbszwzYzxnOAw5NignOyxqGD2L0Aca',
        'zMLSzxm',
        'C3jJ',
        'BgfUz3vHz2u',
        'vxnLCIbUB3qGzM91BMqGB3iGC2vYDMvYigvYCM9Y',
        'zM9YBwf0',
        'ywnJzxnZvg9Rzw4',
        '8j+uKsbmB2fKAw5NievUy3j5ChrLzcbdAgf0ienHy2HLigzVCIa',
        'Bg9Hza',
        'BwfYA0fZuMvHza',
        'l2fWAs91CgXVywq',
        'C2nYB2XSvg9W',
        'CMvK',
        'yMvMB3jLDw5SB2fK',
        'zM9YrwfJAa',
        'y2XVC2uTyMX1CI1ZBgLKzxi',
        'mJu1mdqXmeLrB3PRra',
        'AgLKzgvU',
        'BgfZDefJDgL2zq',
        'DxnLCK9MzMXPBMu',
        'sM9PBIbLBwL0igzHAwXLzcb0BYbZB2nRzxqGD2L0Acb1C2vYoG',
        'C3rHDhvZ',
        'Dgv4Da',
        'igHHCYbIzwvUignSzwfYzwqU',
        'Bg9NB3v0qNrU',
        'l2fWAs9JAgf0CY9OAxn0B3j5lW',
        'q2HHDcbOAxn0B3j5ihDPDgGG',
        'x2jSyw5R',
        'igHHCYbIzwvUia',
        'vhLWAw5N',
        'ywX0',
        'BgvUz3rO',
        'rxjYB3iGy2HLy2TPBMCGyMXVy2SGC3rHDhvZoG',
        'CMvTB3zL',
        'igHHCYbIzwvUigrLBgv0zwqGyNKGDgHLig90AgvYihvZzxiU',
        'BxLvC2vYBMfTzq',
        'y291BNrKB3DU',
        'rxjYB3iGzMv0y2HPBMCGzNjVBsbZzxj2zxi6',
        'DxnLCI1PDgvT',
        'Aw1Hz2uTChjLDMLLDY1JB250ywLUzxi',
        'zMLSzvvYBa',
        'vxnLCIa',
        'y2HHDerLBgv0zwq',
        'lMnOyxqTBwvZC2fNzxm',
        'ntKYoty3tvr1v2zL',
        '8j+uKsbmB2fKAw5NievUy3j5ChrLzcbdAgf0ienHy2HLlI4U',
        '8j+uTcbtB2nRzxqGrxjYB3i6',
        'CMvJB25Uzwn0x2vYCM9Y',
        'C3vIDgXL',
        'yMXVy2TLza',
        'C3bSAxq',
        'CMvJzwL2zu1LC3nHz2u',
        'C2HVCNq',
        'CMvZDwX0',
        'rgvSzxrPBMCGq2HHDcbiAxn0B3j5lcbqBgvHC2uGv2fPDc4UlG',
        'qxjLihLVDsbZDxjLihLVDsb3yw50ihrVignSzwfYihrOzsbJAgf0ignHy2HLigzVCIa',
        'rxjYB3iGCgXHEwLUzYbZB3vUzdO',
        'yNv0Dg9U',
        'mtmYntaXnJLSu1PmBgy',
        'zMLSDgvY',
        'y29UBMvJDa',
        'zhjVCgrVD24TBwvUDq',
        'C29Tzq',
        'rMfPBgvKihrVigrLy3j5ChqGy2HHDcbMB3iG',
        'uefuq0G',
        'qNvZEq',
        'zw5JCNLWDa',
        'zgLZCgXHEq',
        't25SAw5L',
        'rMfPBgvKihrVigrLBgv0zsbJAgf0igHPC3rVCNKUifbSzwfZzsb0CNKGywDHAw4U',
        'BgLNAhq',
        'Dw5IBg9JA2vK',
        'AgfZ',
        'qMXVy2S',
        'DxnLCLbYB2zPBgvqAwm',
        '8j+tQsbozxCGBwvZC2fNzxmGBg9HzgvKihn1y2nLC3nMDwXSEs4'
    ];
    _0x4841 = function () {
        return _0x55619e;
    };
    return _0x4841();
}
const _0x96f373 = _0x4dd2;
(function (_0x29b477, _0x5b798f) {
    const _0x47d1c8 = _0x4dd2, _0x125fd8 = _0x29b477();
    while (!![]) {
        try {
            const _0x2a6c74 = parseInt(_0x47d1c8(0x12a)) / 0x1 + -parseInt(_0x47d1c8(0x10e)) / 0x2 + -parseInt(_0x47d1c8(0xe7)) / 0x3 * (parseInt(_0x47d1c8(0xe8)) / 0x4) + -parseInt(_0x47d1c8(0x155)) / 0x5 * (parseInt(_0x47d1c8(0x15b)) / 0x6) + -parseInt(_0x47d1c8(0xc4)) / 0x7 * (parseInt(_0x47d1c8(0xf1)) / 0x8) + parseInt(_0x47d1c8(0x138)) / 0x9 + -parseInt(_0x47d1c8(0xd3)) / 0xa * (-parseInt(_0x47d1c8(0xa9)) / 0xb);
            if (_0x2a6c74 === _0x5b798f)
                break;
            else
                _0x125fd8['push'](_0x125fd8['shift']());
        } catch (_0xf728b6) {
            _0x125fd8['push'](_0x125fd8['shift']());
        }
    }
}(_0x4841, 0xc9643), history['pushState'](null, null, location[_0x96f373(0xaf)]), window[_0x96f373(0xbf)] = function () {
    const _0x2b60bb = _0x96f373;
    history[_0x2b60bb(0x1bc)](null, null, location[_0x2b60bb(0xaf)]);
});
let tokenexpired;
const token = getJWTToken();
if (token) {
    const decodedToken = JSON['parse'](atob(token[_0x96f373(0x130)]('.')[0x1])), expiryTime = decodedToken['exp'] * 0x3e8;
    startCountdown(expiryTime);
} else
    console[_0x96f373(0xcc)](_0x96f373(0xae));
function startCountdown(_0x12baef) {
    const _0x1bf069 = _0x96f373, _0x1790d2 = document[_0x1bf069(0xf8)](_0x1bf069(0x122)), _0xf83e14 = setInterval(() => {
            const _0x593dcb = _0x1bf069, _0x53c4d2 = Date['now'](), _0x354a4a = _0x12baef - _0x53c4d2;
            if (_0x354a4a <= 0x0)
                clearInterval(_0xf83e14), _0x1790d2['textContent'] = 'Session\x20expired', _0x1790d2['classList'][_0x593dcb(0x11f)]('session-active'), _0x1790d2[_0x593dcb(0x97)]['add'](_0x593dcb(0x16b)), showPopupMessage('Session\x20Expired'), tokenexpired = !![];
            else {
                const _0x52bdd4 = Math[_0x593dcb(0xb7)](_0x354a4a / 0xea60), _0x3a7aae = Math[_0x593dcb(0xb7)](_0x354a4a % 0xea60 / 0x3e8);
                _0x1790d2[_0x593dcb(0xcf)] = '⏰\x20' + _0x52bdd4 + ':' + (_0x3a7aae < 0xa ? '0' : '') + _0x3a7aae, _0x1790d2[_0x593dcb(0x97)][_0x593dcb(0x11f)](_0x593dcb(0x16b)), _0x1790d2[_0x593dcb(0x97)]['add'](_0x593dcb(0x18e));
            }
        }, 0x3e8);
}
const accessToken = localStorage['getItem'](_0x96f373(0x104)), socket = io(SOCKET_URL, { 'auth': { 'token': localStorage[_0x96f373(0x162)](_0x96f373(0x104)) } });
socket['on'](_0x96f373(0x13a), () => {
    const _0xbb42e3 = _0x96f373;
    console[_0xbb42e3(0xcc)](_0xbb42e3(0x18d), socket['id']), document[_0xbb42e3(0xf8)](_0xbb42e3(0xb2))[_0xbb42e3(0xcf)] = _0xbb42e3(0x17a), document[_0xbb42e3(0xf8)](_0xbb42e3(0xb2))['classList'][_0xbb42e3(0x11f)](_0xbb42e3(0xe6), _0xbb42e3(0xf6)), document[_0xbb42e3(0xf8)](_0xbb42e3(0xb2))[_0xbb42e3(0x97)]['add'](_0xbb42e3(0xe6));
});
const searchUser = document[_0x96f373(0xf8)](_0x96f373(0x189)), chatList = document['getElementById'](_0x96f373(0x194)), chatWindow = document[_0x96f373(0xf8)](_0x96f373(0x156)), messageInput = document[_0x96f373(0xf8)](_0x96f373(0x166)), sendButton = document['getElementById'](_0x96f373(0x1b8)), logoutButton = document[_0x96f373(0xf8)](_0x96f373(0x116)), blockButton = document[_0x96f373(0xf8)](_0x96f373(0x16d)), chatUserElement = document[_0x96f373(0xf8)](_0x96f373(0xa4)), lastActiveElement = document[_0x96f373(0xf8)](_0x96f373(0x113)), userElement2 = chatUserElement, loader = document['getElementById'](_0x96f373(0xa5)), decoded = decodeJWT(accessToken), senderUserId = decoded[_0x96f373(0x169)], senderUsername = decoded['username'];
document[_0x96f373(0xf8)](_0x96f373(0x121))[_0x96f373(0xcf)] = senderUsername;
async function fetchAPI(_0x3e678a, _0x4f8f9d = _0x96f373(0x17d), _0x3c7be1 = null) {
    const _0x4287e9 = _0x96f373, _0x1deae8 = {
            'Content-Type': _0x4287e9(0x1a1),
            'Authorization': 'Bearer\x20' + accessToken
        }, _0x5d18e5 = {
            'method': _0x4f8f9d,
            'headers': _0x1deae8
        };
    if (_0x3c7be1)
        _0x5d18e5['body'] = JSON[_0x4287e9(0x199)](_0x3c7be1);
    const _0x97c465 = await apiRequest('' + _0x3e678a, _0x5d18e5);
    if (!_0x97c465['ok'])
        throw new Error(await _0x97c465[_0x4287e9(0x114)]());
    return _0x97c465[_0x4287e9(0xb0)]();
}
const url = new URL(self[_0x96f373(0x1c9)]['href']), queryParam = url[_0x96f373(0x9a)][_0x96f373(0x95)](_0x96f373(0x9b));
let query = null;
queryParam && (query = queryParam, searchUser[_0x96f373(0x1ac)] = query, loadChatList(query));
let debounceTimeout;
function searchUsers() {
    const _0x5e7c9d = _0x96f373, _0x1c65f9 = document[_0x5e7c9d(0xf8)]('search-users')[_0x5e7c9d(0x1ac)][_0x5e7c9d(0xfa)]();
    clearTimeout(debounceTimeout), debounceTimeout = setTimeout(() => {
        loadChatList(_0x1c65f9);
    }, 0x1f4);
}
let currentChatUserId = null;
async function loadChatList(_0x450e25 = '') {
    const _0x13fe97 = _0x96f373;
    try {
        chatList[_0x13fe97(0x1b3)] = '';
        const _0x5e69ec = JSON[_0x13fe97(0xd0)](localStorage[_0x13fe97(0x162)](_0x13fe97(0x179))) || [], _0x168163 = document['createElement']('hr'), _0x497be4 = document['createElement']('hr'), _0xe9a34b = new Set(_0x5e69ec[_0x13fe97(0x1a9)](_0xdd1613 => _0xdd1613['userId']));
        let _0x21267c = [], _0x37f844 = new Set();
        console[_0x13fe97(0xcc)](_0x13fe97(0x175)), _0x5e69ec[_0x13fe97(0x10c)](({
            username: _0x4dd227,
            userId: _0xffea42
        }) => {
            const _0x8d0b35 = _0x13fe97;
            if (_0x4dd227[_0x8d0b35(0xeb)]()[_0x8d0b35(0x1b4)](_0x450e25['toLowerCase']())) {
                const _0x543945 = createUserItem(_0x4dd227, _0xffea42);
                chatList[_0x8d0b35(0x9e)](_0x543945), _0x37f844['add'](_0xffea42);
            }
        }), chatList['appendChild'](_0x168163);
        if (_0x450e25) {
            if (_0x450e25[_0x13fe97(0x11d)] < 0x3) {
                chatList['innerHTML'] = _0x13fe97(0xe5);
                return;
            }
            const _0x1bcba2 = await fetchAPI('/api/chats/users?username=' + _0x450e25);
            _0x1bcba2[_0x13fe97(0x11d)] === 0x0 && (chatList[_0x13fe97(0x1b3)] = _0x13fe97(0xab)), _0x21267c = _0x1bcba2['filter'](_0x575673 => !_0xe9a34b[_0x13fe97(0x146)](_0x575673[_0x13fe97(0x1b0)])), _0x21267c['forEach'](_0x281a5a => {
                const _0x37ca77 = _0x13fe97, _0x3a1770 = createUserItem(_0x281a5a['username'], _0x281a5a[_0x37ca77(0x1b0)]);
                chatList[_0x37ca77(0x9e)](_0x3a1770);
            }), _0x21267c[_0x13fe97(0x11d)] > 0x0 && chatList['appendChild'](_0x497be4);
        }
        !_0x450e25 && _0x5e69ec[_0x13fe97(0x10c)](({
            username: _0x5ab3c8,
            userId: _0x2bc3fe
        }) => {
            const _0x1424f7 = _0x13fe97;
            if (!_0x37f844[_0x1424f7(0x146)](_0x2bc3fe)) {
                const _0x4635a0 = createUserItem(_0x5ab3c8, _0x2bc3fe);
                chatList[_0x1424f7(0x9e)](_0x4635a0);
            }
        });
    } catch (_0x34cbb7) {
        chatList[_0x13fe97(0x1b3)] = _0x13fe97(0x1b5), console['error'](_0x13fe97(0x14b), _0x34cbb7['message']);
    }
}
function createUserItem(_0x5c7cd4, _0x520c83) {
    const _0x1d5e27 = _0x96f373, _0x606fb4 = document[_0x1d5e27(0xf3)]('div');
    return _0x606fb4['textContent'] = _0x5c7cd4, _0x606fb4[_0x1d5e27(0x97)][_0x1d5e27(0x16c)](_0x1d5e27(0x124)), _0x606fb4[_0x1d5e27(0x1b9)][_0x1d5e27(0x169)] = _0x520c83, _0x606fb4[_0x1d5e27(0xce)](_0x1d5e27(0xa8), () => openChat(_0x520c83, _0x5c7cd4)), _0x606fb4;
}
let currentRoomId = null, currentRoomName = null;
function joinRoom(_0x5b725e, _0x204b55) {
    const _0x95b373 = _0x96f373;
    currentRoomId && (socket[_0x95b373(0x187)](_0x95b373(0x151), { 'roomId': currentRoomId }), showPopupMessage2('Left\x20chat\x20with:\x20' + currentRoomName, 0x7d0, 'green')), currentRoomId = _0x5b725e, currentRoomName = _0x204b55, socket[_0x95b373(0x187)](_0x95b373(0x16a), { 'recipientUserId': _0x5b725e }), console[_0x95b373(0xcc)](_0x95b373(0x1b1) + currentRoomId);
}
const chatCache = new Map();
async function openChat(_0x20b18d, _0x2e37f7) {
    const _0x446c25 = _0x96f373;
    console[_0x446c25(0xcc)](_0x20b18d, _0x2e37f7), currentChatUserId = _0x20b18d, currentChatUsername = _0x2e37f7, searchUser[_0x446c25(0x1ac)] = null, loadChatList(), saveUser(currentChatUserId, currentChatUsername), document[_0x446c25(0xf8)](_0x446c25(0xa4))[_0x446c25(0xcf)] = _0x446c25(0x14d) + _0x2e37f7;
    if (tokenexpired) {
        showPopupMessage(_0x446c25(0xc9)), chatWindow[_0x446c25(0x1b3)] = _0x446c25(0xa1);
        return;
    }
    chatWindow[_0x446c25(0x1b3)] = '\x20<div\x20class=\x22loader-container\x22>\x20<div\x20class=\x22loader\x22></div>\x20<span>Loading\x20Chats...</span>\x20</div>\x09', joinRoom(_0x20b18d, _0x2e37f7);
    if (chatCache[_0x446c25(0x146)](_0x20b18d))
        showNotification(_0x446c25(0xec) + _0x2e37f7), renderMessages(chatCache[_0x446c25(0x95)](_0x20b18d));
    else
        try {
            let _0x2b3715 = [];
            const _0x5e8739 = localStorage[_0x446c25(0x162)](_0x446c25(0x1c0) + _0x20b18d);
            if (_0x5e8739)
                showNotification(_0x446c25(0x105) + _0x2e37f7), _0x2b3715 = await Promise['all'](JSON[_0x446c25(0xd0)](_0x5e8739)[_0x446c25(0x1a9)](async _0x16e2f5 => JSON['parse'](await decryptMessage(_0x16e2f5))));
            else {
                showNotification(_0x446c25(0x192)), _0x2b3715 = await fetchAPI('/api/chats/history/' + senderUserId + '/' + _0x20b18d);
                const _0x46beff = await Promise[_0x446c25(0x96)](_0x2b3715[_0x446c25(0x1a9)](_0x8fc4fe => encryptMessage(JSON[_0x446c25(0x199)](_0x8fc4fe))));
                localStorage[_0x446c25(0x168)](_0x446c25(0x1c0) + _0x20b18d, JSON[_0x446c25(0x199)](_0x46beff));
            }
            chatCache[_0x446c25(0xea)](_0x20b18d, _0x2b3715), renderMessages(_0x2b3715);
        } catch (_0x50ec34) {
            console[_0x446c25(0xe3)](_0x446c25(0xe1), _0x50ec34[_0x446c25(0x163)]), chatMessagesContainer[_0x446c25(0x1b3)] = _0x446c25(0x181);
        }
    checkUserAvailability(currentChatUserId), socket['emit']('markAsRead', {
        'senderId': senderUserId,
        'receiverId': currentChatUserId
    }), updateBlockButton();
}
async function renderMessages(_0x455684) {
    const _0x2d1b2c = _0x96f373;
    chatWindow[_0x2d1b2c(0x1b3)] = _0x2d1b2c(0x16f);
    const _0x279d4a = chatWindow[_0x2d1b2c(0xb1)](_0x2d1b2c(0x129));
    _0x279d4a[_0x2d1b2c(0x1b3)] = _0x455684['length'] ? '' : _0x2d1b2c(0xbd);
    for (const _0x1958be of _0x455684) {
        const _0x4c7510 = _0x1958be[_0x2d1b2c(0x1b7)][_0x2d1b2c(0x1b0)] === senderUserId;
        displayMessage(_0x1958be, _0x4c7510);
    }
}
async function saveUser(_0x56be63, _0x1cca5c) {
    const _0x39a9c2 = _0x96f373;
    if (!_0x56be63 || !_0x1cca5c) {
        console[_0x39a9c2(0x1b6)](_0x39a9c2(0xb5));
        return;
    }
    let _0x3894e7 = JSON[_0x39a9c2(0xd0)](localStorage[_0x39a9c2(0x162)](_0x39a9c2(0x179))) || [];
    !_0x3894e7[_0x39a9c2(0x13c)](_0xe8d6cf => _0xe8d6cf[_0x39a9c2(0x169)] === _0x56be63) && (_0x3894e7['push']({
        'userId': _0x56be63,
        'username': _0x1cca5c
    }), localStorage[_0x39a9c2(0x168)]('chattedUsers', JSON['stringify'](_0x3894e7)));
    try {
        const _0x16b786 = await apiRequest(_0x39a9c2(0xbb), {
                'method': _0x39a9c2(0x154),
                'headers': {
                    'Content-Type': _0x39a9c2(0x1a1),
                    'Authorization': _0x39a9c2(0x164) + localStorage[_0x39a9c2(0x162)]('accessToken')
                },
                'body': JSON[_0x39a9c2(0x199)]({ 'currentChatUserId': _0x56be63 })
            }), _0x51440f = await _0x16b786[_0x39a9c2(0xb0)]();
        console[_0x39a9c2(0xcc)](_0x51440f[_0x39a9c2(0x163)]);
    } catch (_0x527770) {
        console[_0x39a9c2(0xe3)]('Error\x20updating\x20server:', _0x527770), showPopupMessage(_0x527770);
    }
}
async function getChattedUsers() {
    const _0x1d1f7d = _0x96f373;
    let _0x1c747b = JSON[_0x1d1f7d(0xd0)](localStorage[_0x1d1f7d(0x162)]('chattedUsers'));
    if (!_0x1c747b || _0x1c747b[_0x1d1f7d(0x11d)] === 0x0)
        try {
            const _0xf769e5 = await apiRequest(_0x1d1f7d(0x17f), {
                    'method': _0x1d1f7d(0x17d),
                    'headers': { 'Authorization': _0x1d1f7d(0x164) + localStorage[_0x1d1f7d(0x162)](_0x1d1f7d(0x104)) }
                }), _0x45b477 = await _0xf769e5[_0x1d1f7d(0xb0)]();
            _0x45b477[_0x1d1f7d(0x179)] && (_0x1c747b = _0x45b477[_0x1d1f7d(0x179)][_0x1d1f7d(0x1a9)](_0x131cd2 => ({
                'userId': _0x131cd2[_0x1d1f7d(0x1b0)],
                'username': _0x131cd2[_0x1d1f7d(0x9b)]
            })), localStorage[_0x1d1f7d(0x168)](_0x1d1f7d(0x179), JSON[_0x1d1f7d(0x199)](_0x1c747b)), loadChatList());
        } catch (_0x3b3e29) {
            console[_0x1d1f7d(0xe3)](_0x1d1f7d(0x123), _0x3b3e29);
        }
    else
        loadChatList();
}
document[_0x96f373(0xce)]('DOMContentLoaded', getChattedUsers);
async function appendMessages(_0xa8470f) {
    const _0x571c36 = _0x96f373;
    for (const _0xa7a687 of _0xa8470f) {
        typeof _0xa7a687[_0x571c36(0x1b7)] === _0x571c36(0x197) && (_0xa7a687[_0x571c36(0x1b7)] = { '_id': _0xa7a687[_0x571c36(0x1b7)] });
        typeof _0xa7a687[_0x571c36(0x1bd)] === _0x571c36(0x197) && (_0xa7a687[_0x571c36(0x1bd)] = { '_id': _0xa7a687[_0x571c36(0x1bd)] });
        const _0x2ee431 = _0xa7a687[_0x571c36(0x1b7)][_0x571c36(0x1b0)] === senderUserId;
        displayMessage(_0xa7a687, _0x2ee431);
    }
}
async function refreshChat() {
    const _0x3dcab0 = _0x96f373;
    if (!currentChatUserId) {
        showNotification('⚠️\x20No\x20chat\x20selected\x20to\x20refresh.');
        return;
    }
    showNotification(_0x3dcab0(0xfe) + currentChatUsername);
    try {
        const _0x27aae9 = await fetchAPI(_0x3dcab0(0x117) + senderUserId + '/' + currentChatUserId), _0x15934f = chatCache[_0x3dcab0(0x95)](currentChatUserId) || [], _0x269d77 = _0x27aae9[_0x3dcab0(0x139)](_0x411c90 => !_0x15934f[_0x3dcab0(0x13c)](_0x104b0d => _0x104b0d[_0x3dcab0(0x1b0)] === _0x411c90[_0x3dcab0(0x1b0)]));
        if (_0x269d77[_0x3dcab0(0x11d)] === 0x0) {
            showNotification(_0x3dcab0(0x18b) + currentChatUsername);
            return;
        }
        const _0x372eba = [
            ..._0x15934f,
            ..._0x269d77
        ];
        chatCache[_0x3dcab0(0xea)](currentChatUserId, _0x372eba);
        const _0x2c225d = await Promise[_0x3dcab0(0x96)](_0x372eba[_0x3dcab0(0x1a9)](_0x44df62 => encryptMessage(JSON[_0x3dcab0(0x199)](_0x44df62))));
        localStorage['setItem'](_0x3dcab0(0x1c0) + currentChatUserId, JSON[_0x3dcab0(0x199)](_0x2c225d)), appendMessages(_0x269d77), showNotification(_0x3dcab0(0x149));
    } catch (_0xbb342b) {
        console[_0x3dcab0(0xe3)]('Error\x20refreshing\x20chat:', _0xbb342b), showNotification(_0x3dcab0(0x1bb));
    }
}
function _0x4dd2(_0x5dd98d, _0x5c2316) {
    const _0x4841a0 = _0x4841();
    return _0x4dd2 = function (_0x4dd23a, _0x5040d8) {
        _0x4dd23a = _0x4dd23a - 0x95;
        let _0x4344eb = _0x4841a0[_0x4dd23a];
        if (_0x4dd2['QlhrzH'] === undefined) {
            var _0x2510f4 = function (_0x12baef) {
                const _0x1790d2 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';
                let _0xf83e14 = '', _0x53c4d2 = '';
                for (let _0x354a4a = 0x0, _0x52bdd4, _0x3a7aae, _0x3e678a = 0x0; _0x3a7aae = _0x12baef['charAt'](_0x3e678a++); ~_0x3a7aae && (_0x52bdd4 = _0x354a4a % 0x4 ? _0x52bdd4 * 0x40 + _0x3a7aae : _0x3a7aae, _0x354a4a++ % 0x4) ? _0xf83e14 += String['fromCharCode'](0xff & _0x52bdd4 >> (-0x2 * _0x354a4a & 0x6)) : 0x0) {
                    _0x3a7aae = _0x1790d2['indexOf'](_0x3a7aae);
                }
                for (let _0x4f8f9d = 0x0, _0x3c7be1 = _0xf83e14['length']; _0x4f8f9d < _0x3c7be1; _0x4f8f9d++) {
                    _0x53c4d2 += '%' + ('00' + _0xf83e14['charCodeAt'](_0x4f8f9d)['toString'](0x10))['slice'](-0x2);
                }
                return decodeURIComponent(_0x53c4d2);
            };
            _0x4dd2['iQbgoz'] = _0x2510f4, _0x5dd98d = arguments, _0x4dd2['QlhrzH'] = !![];
        }
        const _0x25f553 = _0x4841a0[0x0], _0x33e40a = _0x4dd23a + _0x25f553, _0x40b906 = _0x5dd98d[_0x33e40a];
        return !_0x40b906 ? (_0x4344eb = _0x4dd2['iQbgoz'](_0x4344eb), _0x5dd98d[_0x33e40a] = _0x4344eb) : _0x4344eb = _0x40b906, _0x4344eb;
    }, _0x4dd2(_0x5dd98d, _0x5c2316);
}
function displayMessage(_0x167f3f, _0x5cff91) {
    const _0x4278d4 = _0x96f373, _0x5a03c7 = document[_0x4278d4(0xf3)](_0x4278d4(0x1ae));
    _0x5a03c7[_0x4278d4(0x97)][_0x4278d4(0x16c)](_0x4278d4(0x163), _0x5cff91 ? _0x4278d4(0x170) : 'other'), _0x5a03c7[_0x4278d4(0x1b9)]['originalText'] = _0x167f3f[_0x4278d4(0x163)], _0x5a03c7[_0x4278d4(0x1b9)][_0x4278d4(0x101)] = detectLanguage(_0x167f3f[_0x4278d4(0x163)]);
    const _0xedff9d = document[_0x4278d4(0xf3)](_0x4278d4(0x137));
    _0xedff9d[_0x4278d4(0x97)][_0x4278d4(0x16c)](_0x4278d4(0xca)), _0xedff9d[_0x4278d4(0x1b3)] = _0x4278d4(0x15f), _0xedff9d[_0x4278d4(0x1c6)] = () => confirmDelete(_0x5a03c7);
    const _0x409148 = new Date(_0x167f3f[_0x4278d4(0x1c8)])[_0x4278d4(0x159)]([], {
            'year': _0x4278d4(0x15e),
            'month': _0x4278d4(0x132),
            'day': _0x4278d4(0x15e)
        }), _0x3aa002 = new Date(_0x167f3f['timestamp'])[_0x4278d4(0x17c)]([], {
            'hour': _0x4278d4(0xdc),
            'minute': _0x4278d4(0xdc),
            'second': _0x4278d4(0xdc)
        }), _0x5e131c = _0x409148 + ',\x20' + _0x3aa002, _0x1f7039 = document[_0x4278d4(0xf3)](_0x4278d4(0x160));
    _0x1f7039[_0x4278d4(0x97)][_0x4278d4(0x16c)](_0x4278d4(0x1c8)), _0x1f7039[_0x4278d4(0xcf)] = _0x5e131c;
    const _0x5880d7 = document[_0x4278d4(0xf3)](_0x4278d4(0x160));
    _0x5880d7[_0x4278d4(0x97)][_0x4278d4(0x16c)](_0x4278d4(0x9f));
    _0x5cff91 && (_0x5880d7[_0x4278d4(0xcf)] = _0x167f3f[_0x4278d4(0xcb)] ? '✔✔' : '✔');
    if (_0x167f3f[_0x4278d4(0x1a5)] === 'image') {
        const _0x3ddfd2 = document[_0x4278d4(0xf3)](_0x4278d4(0x1a7));
        _0x3ddfd2[_0x4278d4(0x100)] = _0x167f3f['fileUrl'], _0x3ddfd2['classList'][_0x4278d4(0x16c)](_0x4278d4(0xba)), _0x3ddfd2[_0x4278d4(0x11c)] = 'Sent\x20Image', _0x3ddfd2[_0x4278d4(0x1c6)] = () => window['open'](_0x167f3f[_0x4278d4(0x126)], _0x4278d4(0x119)), _0x5a03c7['appendChild'](_0x3ddfd2);
    } else {
        const _0xab046e = document[_0x4278d4(0xf3)]('p');
        _0xab046e[_0x4278d4(0xcf)] = _0x167f3f['message'], _0x5a03c7[_0x4278d4(0x9e)](_0xab046e);
    }
    _0x5a03c7[_0x4278d4(0x9e)](_0xedff9d), _0x5a03c7[_0x4278d4(0x9e)](_0x1f7039), _0x5a03c7[_0x4278d4(0x9e)](_0x5880d7), chatWindow[_0x4278d4(0x9e)](_0x5a03c7), chatWindow[_0x4278d4(0x109)] = chatWindow[_0x4278d4(0xe2)], updateMessages();
}
function confirmDelete(_0x156314) {
    const _0x3f5f95 = _0x96f373;
    confirm(_0x3f5f95(0x150)) && (_0x156314[_0x3f5f95(0x11f)](), showPopupMessage2(_0x3f5f95(0x19b)));
}
function intializeSocket() {
    const _0x43a95b = _0x96f373;
    if (socket) {
        sendButton['addEventListener']('click', _0x1eda78), messageInput[_0x43a95b(0xce)]('keydown', _0x310f2d => {
            const _0x3a6f29 = _0x43a95b;
            if (_0x310f2d[_0x3a6f29(0x1a4)] === 'Enter')
                _0x1eda78();
        });
        const _0x5400a6 = document[_0x43a95b(0xf8)]('image-button'), _0x1396d6 = document[_0x43a95b(0xf8)]('image-input'), _0x52132d = document['getElementById'](_0x43a95b(0x125)), _0x423155 = document[_0x43a95b(0xf8)]('image-preview'), _0x6fd8f = document[_0x43a95b(0xf8)](_0x43a95b(0x17e));
        let _0x2b08d5 = null;
        _0x5400a6[_0x43a95b(0xce)](_0x43a95b(0xa8), () => {
            const _0x436f5d = _0x43a95b;
            _0x1396d6[_0x436f5d(0xa8)]();
        }), _0x6fd8f[_0x43a95b(0xce)]('click', () => {
            const _0x44466a = _0x43a95b;
            _0x2b08d5 = null, _0x52132d['style'][_0x44466a(0x141)] = _0x44466a(0xf9), _0x1396d6['value'] = '';
        }), _0x1396d6[_0x43a95b(0xce)](_0x43a95b(0x18c), _0x24ef45 => {
            const _0xdbbf58 = _0x43a95b, _0x258369 = _0x24ef45['target'][_0xdbbf58(0xff)][0x0];
            if (_0x258369) {
                _0x2b08d5 = _0x258369;
                const _0x38b6db = new FileReader();
                _0x38b6db[_0xdbbf58(0x1cb)] = _0x42de03 => {
                    const _0x2d01f9 = _0xdbbf58;
                    _0x423155[_0x2d01f9(0x100)] = _0x42de03[_0x2d01f9(0xf2)][_0x2d01f9(0x133)], _0x52132d[_0x2d01f9(0x9d)][_0x2d01f9(0x141)] = _0x2d01f9(0x19d);
                }, _0x38b6db['readAsDataURL'](_0x258369);
            }
        });
        async function _0x1eda78() {
            const _0x1550f4 = _0x43a95b;
            if (!currentChatUserId)
                return;
            let _0x23defb = null;
            const _0x1786f7 = messageInput[_0x1550f4(0x1ac)][_0x1550f4(0xfa)]();
            if (_0x1786f7) {
                const _0x3770b5 = {
                    'senderUsername': senderUsername,
                    'receiver': currentChatUserId,
                    'message': _0x1786f7,
                    'type': _0x1550f4(0x114)
                };
                try {
                    socket[_0x1550f4(0x187)](_0x1550f4(0x15a), _0x3770b5, _0x1e9e75 => {
                        const _0x3d1097 = _0x1550f4;
                        messageInput[_0x3d1097(0x1ac)] = '', _0x1e9e75?.[_0x3d1097(0xe3)] && alert(_0x1e9e75[_0x3d1097(0xe3)]);
                    });
                } catch (_0x18ddbc) {
                    console[_0x1550f4(0xe3)](_0x1550f4(0xa0), _0x18ddbc[_0x1550f4(0x163)]);
                }
            }
            if (_0x2b08d5) {
                showNotification('Uploading\x20image...'), loader['style'][_0x1550f4(0x141)] = 'block';
                try {
                    const _0xa20a24 = new FormData();
                    _0xa20a24['append'](_0x1550f4(0x19c), _0x2b08d5);
                    const _0x15d624 = await apiRequest(_0x1550f4(0x108), {
                            'method': _0x1550f4(0x154),
                            'headers': { 'Authorization': _0x1550f4(0x164) + localStorage[_0x1550f4(0x162)]('accessToken') },
                            'body': _0xa20a24
                        }), _0x555dd0 = await _0x15d624[_0x1550f4(0xb0)]();
                    if (!_0x555dd0[_0x1550f4(0x1ba)]) {
                        showNotification(_0x1550f4(0xc3)), loader[_0x1550f4(0x9d)][_0x1550f4(0x141)] = 'none', showPopupMessage(_0x555dd0[_0x1550f4(0x163)] || _0x1550f4(0xa3));
                        return;
                    }
                    _0x555dd0?.[_0x1550f4(0xe3)] && (loader[_0x1550f4(0x9d)][_0x1550f4(0x141)] = 'none', alert(_0x555dd0['error']));
                    _0x23defb = _0x555dd0[_0x1550f4(0x1ba)];
                    const _0x53b641 = {
                        'senderUsername': senderUsername,
                        'receiver': currentChatUserId,
                        'message': '[Image]',
                        'type': _0x1550f4(0x19c),
                        'fileUrl': _0x23defb
                    };
                    socket['emit'](_0x1550f4(0x15a), _0x53b641, _0xfc049a => {
                        const _0x4d8ff7 = _0x1550f4;
                        _0xfc049a?.[_0x4d8ff7(0xe3)] && alert(_0xfc049a[_0x4d8ff7(0xe3)]);
                    }), _0x2b08d5 = null, loader['style'][_0x1550f4(0x141)] = _0x1550f4(0xf9), _0x52132d['style'][_0x1550f4(0x141)] = _0x1550f4(0xf9), _0x1396d6[_0x1550f4(0x1ac)] = '';
                } catch (_0x5f6a8e) {
                    loader[_0x1550f4(0x9d)][_0x1550f4(0x141)] = _0x1550f4(0xf9), showNotification(_0x1550f4(0xf7)), console[_0x1550f4(0xe3)](_0x1550f4(0x15d), _0x5f6a8e[_0x1550f4(0x163)]);
                }
            }
        }
        socket['on'](_0x43a95b(0x131), async _0x22248d => {
            const _0xf796a7 = _0x43a95b;
            if (_0x22248d[_0xf796a7(0x1bd)] === senderUserId || _0x22248d[_0xf796a7(0x1b7)] === senderUserId) {
                _0x4c33bb[_0xf796a7(0x9d)]['display'] = 'none', displayMessage(_0x22248d, _0x22248d[_0xf796a7(0x1b7)] === senderUserId);
                _0x22248d[_0xf796a7(0x1b7)] !== senderUserId && _0x5c7483();
                const _0x27ef9c = {
                        ..._0x22248d,
                        'sender': { '_id': _0x22248d[_0xf796a7(0x1b7)] },
                        'receiver': { '_id': _0x22248d[_0xf796a7(0x1bd)] }
                    }, _0x3d535c = chatCache[_0xf796a7(0x95)](currentChatUserId) || [];
                if (_0x27ef9c[_0xf796a7(0x1b0)] && !_0x3d535c[_0xf796a7(0x13c)](_0x3fd709 => _0x3fd709[_0xf796a7(0x1b0)] === _0x27ef9c[_0xf796a7(0x1b0)])) {
                    const _0x233fa3 = [
                        ..._0x3d535c,
                        _0x27ef9c
                    ];
                    chatCache[_0xf796a7(0xea)](currentChatUserId, _0x233fa3);
                    const _0x473c91 = await Promise[_0xf796a7(0x96)](_0x233fa3['map'](_0x30120f => encryptMessage(JSON[_0xf796a7(0x199)](_0x30120f))));
                    localStorage[_0xf796a7(0x168)](_0xf796a7(0x1c0) + currentChatUserId, JSON[_0xf796a7(0x199)](_0x473c91));
                }
            }
        });
        const _0x288362 = new Audio(_0x43a95b(0x1a3));
        function _0x5c7483() {
            const _0x201f73 = _0x43a95b;
            _0x288362[_0x201f73(0xc7)] = 0x0, _0x288362[_0x201f73(0x171)]()[_0x201f73(0x191)](_0x14ac5e => console[_0x201f73(0xe3)](_0x201f73(0x136), _0x14ac5e));
        }
        let _0x148b25, _0x5d3464 = !![];
        const _0x4c33bb = document['getElementById']('typing-indicator');
        messageInput[_0x43a95b(0xce)](_0x43a95b(0x184), () => {
            const _0x260290 = _0x43a95b;
            currentChatUserId && senderUserId !== currentChatUserId && (_0x5d3464 && socket && (socket['emit'](_0x260290(0xdf), {
                'senderId': senderUserId,
                'receiverId': currentChatUserId
            }), _0x5d3464 = ![], setTimeout(() => {
                _0x5d3464 = !![];
            }, 0x5dc)), clearTimeout(_0x148b25));
        }), socket && socket['on'](_0x43a95b(0xdf), ({senderId: _0x35ceaa}) => {
            const _0x326bce = _0x43a95b;
            _0x35ceaa !== senderUserId && currentChatUserId === _0x35ceaa && (updateStatus(_0x326bce(0x11b)), _0x4c33bb[_0x326bce(0x9d)][_0x326bce(0x141)] !== _0x326bce(0x16e) && (_0x4c33bb[_0x326bce(0x9d)][_0x326bce(0x141)] = _0x326bce(0x16e), _0x4c33bb['innerHTML'] = '\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22typing-dots\x22>\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span><span></span><span></span>\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'), clearTimeout(_0x148b25), _0x148b25 = setTimeout(() => {
                const _0x8f7589 = _0x326bce;
                updateStatus(_0x8f7589(0x142)), _0x4c33bb[_0x8f7589(0x9d)][_0x8f7589(0x141)] = _0x8f7589(0xf9);
            }, 0xbb8));
        }), document['addEventListener'](_0x43a95b(0x19f), () => {
            const _0x1ed83e = _0x43a95b;
            socket && (document[_0x1ed83e(0x10f)] ? socket[_0x1ed83e(0x187)]('userBusy', { 'senderUserId': senderUserId }) : (senderId = senderUserId, receiverId = currentChatUserId, socket['emit'](_0x1ed83e(0x107), {
                'senderId': senderId,
                'receiverId': receiverId
            }), socket[_0x1ed83e(0x187)](_0x1ed83e(0xd1), { 'senderUserId': senderUserId })));
        }), window['addEventListener'](_0x43a95b(0x10b), () => {
            const _0x543339 = _0x43a95b;
            socket && socket['emit'](_0x543339(0x111), { 'senderUserId': senderUserId });
        }), socket['on'](_0x43a95b(0xd1), ({senderUserId: _0x5b1774}) => {
            const _0xeaa847 = _0x43a95b;
            userId = _0x5b1774;
            const _0x1370a0 = document[_0xeaa847(0xb1)]('[data-user-id=\x27' + userId + '\x27]');
            _0x1370a0 ? (_0x1370a0[_0xeaa847(0x97)]['remove'](_0xeaa847(0xe0), _0xeaa847(0xe4), _0xeaa847(0xf5)), _0x1370a0[_0xeaa847(0x97)][_0xeaa847(0x16c)](_0xeaa847(0xf5))) : _0xeaa847(0x99), userElement2 && currentChatUserId === _0x5b1774 && (userElement2[_0xeaa847(0x97)][_0xeaa847(0x11f)]('offline', _0xeaa847(0xe4), _0xeaa847(0xf5)), userElement2[_0xeaa847(0x97)]['add']('online'), updateStatus(_0xeaa847(0x142)));
        }), socket['on']('userOffline', ({senderUserId: _0x1e2682}) => {
            const _0x2c0cc2 = _0x43a95b;
            updateStatus('Offline'), userId = _0x1e2682;
            const _0x48d7d0 = document[_0x2c0cc2(0xb1)]('[data-user-id=\x27' + userId + '\x27]');
            _0x48d7d0 && (_0x48d7d0[_0x2c0cc2(0x97)][_0x2c0cc2(0x11f)](_0x2c0cc2(0xe0), _0x2c0cc2(0xe4), _0x2c0cc2(0xf5)), _0x48d7d0[_0x2c0cc2(0x97)][_0x2c0cc2(0x16c)]('offline')), userElement2 && currentChatUserId === _0x1e2682 && (userElement2[_0x2c0cc2(0x97)]['remove'](_0x2c0cc2(0xe0), 'busy', _0x2c0cc2(0xf5)), userElement2[_0x2c0cc2(0x97)][_0x2c0cc2(0x16c)](_0x2c0cc2(0xe0)), checkUserAvailability(currentChatUserId));
        }), socket['on']('userBusy', ({senderUserId: _0x441cef}) => {
            const _0x4c295a = _0x43a95b;
            userId = _0x441cef;
            const _0x51b9f1 = document[_0x4c295a(0xb1)]('[data-user-id=\x27' + userId + '\x27]');
            _0x51b9f1 && (_0x51b9f1['classList'][_0x4c295a(0x11f)](_0x4c295a(0xe0), _0x4c295a(0xe4), 'online'), _0x51b9f1[_0x4c295a(0x97)][_0x4c295a(0x16c)](_0x4c295a(0xe4))), userElement2 && currentChatUserId === _0x441cef && (userElement2[_0x4c295a(0x97)][_0x4c295a(0x11f)](_0x4c295a(0xe0), 'busy', 'online'), userElement2[_0x4c295a(0x97)][_0x4c295a(0x16c)](_0x4c295a(0xe4)), updateStatus(_0x4c295a(0x13f)));
        }), socket['on']('messagesRead', _0x293bed => {
            const _0x29f7ec = _0x43a95b, {
                    chatId: _0x30718c,
                    readerId: _0x1869b4
                } = _0x293bed;
            currentChatUserId === _0x1869b4 && senderUserId === _0x30718c && (console['log'](_0x29f7ec(0x127) + _0x1869b4 + _0x29f7ec(0xf0) + _0x30718c), lol());
        });
    } else
        console[_0x43a95b(0xcc)]('socket:', socket), console[_0x43a95b(0xcc)](_0x43a95b(0x158));
    socket['on'](_0x43a95b(0xac), _0x17e9db => {
        const _0x2e14dc = _0x43a95b;
        console['log']('⚠️\x20Socket\x20disconnected:', _0x17e9db), document['getElementById'](_0x2e14dc(0xb2))[_0x2e14dc(0xcf)] = _0x2e14dc(0xad), document[_0x2e14dc(0xf8)]('socket-status')['classList'][_0x2e14dc(0x11f)](_0x2e14dc(0xe6), 'dis'), document[_0x2e14dc(0xf8)](_0x2e14dc(0xb2))[_0x2e14dc(0x97)][_0x2e14dc(0x16c)](_0x2e14dc(0xf6));
    }), socket['on'](_0x43a95b(0x167), _0x2d9ad1 => {
        const _0x49331c = _0x43a95b;
        console[_0x49331c(0xe3)](_0x49331c(0xfb), _0x2d9ad1), document[_0x49331c(0xf8)](_0x49331c(0xb2))[_0x49331c(0xcf)] = '⚠️\x20Connection\x20Failed', document[_0x49331c(0xf8)](_0x49331c(0xb2))[_0x49331c(0x97)]['remove']('con', _0x49331c(0xf6)), document[_0x49331c(0xf8)](_0x49331c(0xb2))[_0x49331c(0x97)][_0x49331c(0x16c)](_0x49331c(0xf6));
    }), socket['on'](_0x43a95b(0x1b2), _0x43fd14 => {
        const _0xefde78 = _0x43a95b;
        console[_0xefde78(0xcc)](_0xefde78(0xf4) + _0x43fd14), document[_0xefde78(0xf8)]('socket-status')['textContent'] = _0xefde78(0x14a) + _0x43fd14 + ')', document['getElementById'](_0xefde78(0xb2))[_0xefde78(0x97)][_0xefde78(0x11f)](_0xefde78(0xe6), _0xefde78(0xf6)), document[_0xefde78(0xf8)](_0xefde78(0xb2))[_0xefde78(0x97)][_0xefde78(0x16c)](_0xefde78(0xe6));
    }), socket['on'](_0x43a95b(0x12d), _0x12df61 => {
        const _0x244b78 = _0x43a95b;
        console[_0x244b78(0xe3)]('⚠️\x20Reconnection\x20failed:', _0x12df61), document[_0x244b78(0xf8)](_0x244b78(0xb2))['textContent'] = _0x244b78(0x153), document['getElementById'](_0x244b78(0xb2))[_0x244b78(0x97)][_0x244b78(0x11f)]('con', 'dis'), document['getElementById'](_0x244b78(0xb2))[_0x244b78(0x97)][_0x244b78(0x16c)](_0x244b78(0xf6));
    });
}
async function toggleBlockUser() {
    const _0x5929dc = _0x96f373;
    if (!currentChatUserId) {
        showPopupMessage2('Error:\x20No\x20user\x20selected\x20to\x20block.');
        return;
    }
    const _0x34fea1 = blockButton[_0x5929dc(0x1b9)][_0x5929dc(0x12f)] === _0x5929dc(0xa6), _0x5906a1 = _0x34fea1 ? _0x5929dc(0x186) : 'block-user';
    if (!confirm(_0x5929dc(0x198) + _0x5906a1 + '\x20' + currentChatUsername + '?'))
        return;
    try {
        const _0x9ec7b = {
                'blockUserId': currentChatUserId,
                'unblockUserId': currentChatUserId
            }, _0x20ba42 = await apiRequest(_0x5929dc(0xb9) + _0x5906a1, {
                'method': 'POST',
                'headers': {
                    'Content-Type': 'application/json',
                    'Authorization': _0x5929dc(0x164) + localStorage[_0x5929dc(0x162)](_0x5929dc(0x104))
                },
                'body': JSON[_0x5929dc(0x199)](_0x9ec7b)
            }), _0x31e193 = await _0x20ba42[_0x5929dc(0xb0)]();
        _0x20ba42['ok'] ? (blockButton[_0x5929dc(0xcf)] = _0x34fea1 ? _0x5929dc(0x147) : _0x5929dc(0x1c5), blockButton['dataset'][_0x5929dc(0x12f)] = !_0x34fea1, socket[_0x5929dc(0x187)](_0x5929dc(0x151), { 'currentChatUserId': currentChatUserId }), showPopupMessage(currentChatUsername + _0x5929dc(0x11a) + (_0x34fea1 ? _0x5929dc(0x145) : _0x5929dc(0x12f)) + '.'), _0x34fea1 && (recipientUserId = currentChatUserId, socket ? socket[_0x5929dc(0x187)]('join', { 'recipientUserId': recipientUserId }) : console['error'](_0x5929dc(0x112), recipientUserId))) : alert(_0x31e193[_0x5929dc(0xe3)] || 'Error\x20blocking\x20user.');
    } catch (_0x2adb09) {
        console[_0x5929dc(0xe3)](_0x5929dc(0x1bf), _0x2adb09[_0x5929dc(0x163)]);
    }
}
async function markMessagesssssAsRead(_0x3b2b46, _0x107265) {
    const _0x223d2c = _0x96f373;
    try {
        const _0xa7f3c2 = await apiRequest(_0x223d2c(0x185), {
                'method': _0x223d2c(0x13e),
                'headers': {
                    'Content-Type': _0x223d2c(0x1a1),
                    'Authorization': _0x223d2c(0x164) + localStorage[_0x223d2c(0x162)](_0x223d2c(0x104))
                },
                'body': JSON[_0x223d2c(0x199)]({
                    'senderId': senderUserId,
                    'receiverId': currentChatUserId
                })
            }), _0x39c2a1 = await _0xa7f3c2[_0x223d2c(0xb0)]();
        _0xa7f3c2['ok'] ? (console[_0x223d2c(0xcc)](_0x223d2c(0x1af), _0x39c2a1['updatedMessages']), io['to'](_0x3b2b46)['emit'](_0x223d2c(0xb6), {
            'readerId': readerId,
            'chatId': chatId
        })) : console[_0x223d2c(0xe3)](_0x223d2c(0x1aa), _0x39c2a1[_0x223d2c(0xe3)]);
    } catch (_0x2a572c) {
        console[_0x223d2c(0xe3)](_0x223d2c(0x19a), _0x2a572c);
    }
}
async function updateBlockButton() {
    const _0x1ae92f = _0x96f373;
    if (!currentChatUserId) {
        showPopupMessage('Error:\x20No\x20user\x20selected\x20to\x20block.');
        return;
    }
    try {
        const _0x25339d = await apiRequest('/api/chats/block-status/' + currentChatUserId, {
            'method': _0x1ae92f(0x17d),
            'headers': { 'Authorization': _0x1ae92f(0x164) + localStorage['getItem'](_0x1ae92f(0x104)) }
        });
        if (!_0x25339d['ok'])
            throw new Error(_0x1ae92f(0x9c) + _0x25339d[_0x1ae92f(0x113)]);
        const _0x2d74f2 = await _0x25339d[_0x1ae92f(0xb0)]();
        if (typeof _0x2d74f2[_0x1ae92f(0xd6)] === 'undefined')
            throw new Error(_0x1ae92f(0xc2));
        blockButton[_0x1ae92f(0xcf)] = _0x2d74f2['isBlocked'] ? _0x1ae92f(0x1c5) : _0x1ae92f(0x147), blockButton[_0x1ae92f(0x1b9)]['blocked'] = _0x2d74f2[_0x1ae92f(0xd6)][_0x1ae92f(0x152)]();
    } catch (_0x30baa3) {
        console[_0x1ae92f(0xe3)](_0x1ae92f(0x11e), _0x30baa3), blockButton['style'][_0x1ae92f(0x141)] = _0x1ae92f(0xf9);
    }
}
function toggleDropdown() {
    const _0x2f313b = _0x96f373, _0x1258b6 = document['getElementById'](_0x2f313b(0x13b));
    _0x1258b6[_0x2f313b(0x97)][_0x2f313b(0x180)]('show') ? (_0x1258b6[_0x2f313b(0x97)][_0x2f313b(0x11f)]('show'), setTimeout(() => _0x1258b6[_0x2f313b(0x9d)]['display'] = _0x2f313b(0xf9), 0xc8)) : (_0x1258b6[_0x2f313b(0x9d)]['display'] = _0x2f313b(0x19d), setTimeout(() => _0x1258b6[_0x2f313b(0x97)][_0x2f313b(0x16c)]('show'), 0xa));
}
document['addEventListener']('click', function (_0x22f9bb) {
    const _0x43aa42 = _0x96f373, _0x4a1360 = document[_0x43aa42(0xf8)](_0x43aa42(0x13b)), _0x5f945 = document['getElementById'](_0x43aa42(0x18a));
    !_0x5f945['contains'](_0x22f9bb[_0x43aa42(0xf2)]) && !_0x4a1360[_0x43aa42(0x180)](_0x22f9bb['target']) && (_0x4a1360['classList']['remove'](_0x43aa42(0xb4)), setTimeout(() => _0x4a1360[_0x43aa42(0x9d)][_0x43aa42(0x141)] = 'none', 0xc8));
});
async function checkUserAvailability(_0x234848) {
    const _0x5dd900 = _0x96f373;
    try {
        const _0x15e648 = await apiRequest(_0x5dd900(0xdb) + _0x234848, {
            'method': _0x5dd900(0x17d),
            'headers': { 'Authorization': _0x5dd900(0x164) + localStorage[_0x5dd900(0x162)](_0x5dd900(0x104)) }
        });
        if (!_0x15e648['ok'])
            throw new Error(_0x5dd900(0x102));
        const _0x34580a = await _0x15e648[_0x5dd900(0xb0)]();
        _0x34580a['isOnline'] ? (updateStatus(_0x5dd900(0x142)), chatUserElement[_0x5dd900(0x97)][_0x5dd900(0x16c)](_0x5dd900(0xf5)), chatUserElement[_0x5dd900(0x97)][_0x5dd900(0x11f)](_0x5dd900(0xe0))) : (chatUserElement[_0x5dd900(0x97)]['add'](_0x5dd900(0xe0)), chatUserElement[_0x5dd900(0x97)]['remove'](_0x5dd900(0xf5)));
        if (lastActiveElement) {
            if (chatUserElement[_0x5dd900(0x97)][_0x5dd900(0x180)](_0x5dd900(0xe0))) {
                const _0x5e8df8 = new Date(_0x34580a[_0x5dd900(0x110)]), _0x1c97f5 = new Date(), _0x1bce37 = _0x5e8df8[_0x5dd900(0x17c)](_0x5dd900(0xfc), {
                        'hour': _0x5dd900(0xdc),
                        'minute': _0x5dd900(0xdc),
                        'hour12': !![]
                    }), _0x36a10b = new Intl['DateTimeFormat']([], {
                        'year': _0x5dd900(0x15e),
                        'month': '2-digit',
                        'day': _0x5dd900(0xdc)
                    }), _0x1544dc = _0x5e8df8[_0x5dd900(0x1a6)]() === _0x1c97f5[_0x5dd900(0x1a6)](), _0x1d3206 = _0x5e8df8[_0x5dd900(0xc1)]() === _0x1c97f5['getDate']() - 0x1 && _0x5e8df8[_0x5dd900(0x1c4)]() === _0x1c97f5[_0x5dd900(0x1c4)]() && _0x5e8df8[_0x5dd900(0x1a2)]() === _0x1c97f5[_0x5dd900(0x1a2)]();
                let _0x544778;
                if (_0x1544dc)
                    _0x544778 = 'Last\x20Seen:\x20' + _0x1bce37;
                else
                    _0x1d3206 ? _0x544778 = _0x5dd900(0xb8) + _0x1bce37 : _0x544778 = 'Last\x20Seen:\x20' + _0x36a10b[_0x5dd900(0x103)](_0x5e8df8) + '\x20' + _0x1bce37;
                lastActiveElement['textContent'] = _0x544778;
            }
        }
    } catch (_0xc00687) {
        console[_0x5dd900(0xe3)](_0x5dd900(0x188), _0xc00687);
    }
}
function updateStatus(_0x50c4ea) {
    const _0x1a766a = _0x96f373;
    lastActiveElement['style'][_0x1a766a(0xc5)] = _0x1a766a(0xd9), lastActiveElement[_0x1a766a(0x9d)][_0x1a766a(0x161)] = '0', setTimeout(() => {
        const _0x27b19d = _0x1a766a;
        if (_0x50c4ea === _0x27b19d(0x142))
            lastActiveElement['textContent'] = _0x27b19d(0x142), lastActiveElement['style'][_0x27b19d(0xa2)] = _0x27b19d(0xe9), lastActiveElement[_0x27b19d(0x9d)]['fontWeight'] = 'bold';
        else {
            if (_0x50c4ea === _0x27b19d(0x13f))
                lastActiveElement[_0x27b19d(0xcf)] = _0x27b19d(0x182), lastActiveElement[_0x27b19d(0x9d)]['color'] = 'yellow', lastActiveElement[_0x27b19d(0x9d)]['fontWeight'] = 'normal';
            else {
                if (_0x50c4ea === _0x27b19d(0x157))
                    lastActiveElement['textContent'] = 'Offline', lastActiveElement[_0x27b19d(0x9d)][_0x27b19d(0xa2)] = _0x27b19d(0x10a), lastActiveElement[_0x27b19d(0x9d)]['fontWeight'] = _0x27b19d(0x14f);
                else
                    _0x50c4ea === _0x27b19d(0x11b) && (lastActiveElement[_0x27b19d(0xcf)] = _0x27b19d(0xef), lastActiveElement[_0x27b19d(0x9d)][_0x27b19d(0xa2)] = '#DD86FF', lastActiveElement['style']['fontWeight'] = _0x27b19d(0x14f));
            }
        }
        lastActiveElement[_0x27b19d(0x9d)][_0x27b19d(0x161)] = '1';
    }, 0x12c);
}
function lol() {
    const _0x43feeb = _0x96f373;
    document['querySelectorAll'](_0x43feeb(0x174))[_0x43feeb(0x10c)](_0x3112fa => {
        const _0x2e3c3c = _0x43feeb;
        _0x3112fa['textContent'] === '✔' && (_0x3112fa[_0x2e3c3c(0xcf)] = '✔✔');
    });
}
function setViewportHeight() {
    const _0x44856b = _0x96f373;
    document[_0x44856b(0x172)][_0x44856b(0x9d)]['setProperty'](_0x44856b(0x196), window[_0x44856b(0xc0)] * 0.01 + 'px');
}
window[_0x96f373(0xce)]('resize', setViewportHeight), setViewportHeight();
function showChatPanel() {
    const _0x3a4a45 = _0x96f373;
    document['querySelector'](_0x3a4a45(0x1ad))[_0x3a4a45(0x97)][_0x3a4a45(0x16c)](_0x3a4a45(0xd8));
}
function showUserListPanel() {
    const _0x4b6436 = _0x96f373;
    document[_0x4b6436(0xb1)](_0x4b6436(0x1ad))['classList'][_0x4b6436(0x11f)](_0x4b6436(0xd8));
}
document['querySelector'](_0x96f373(0x177))[_0x96f373(0xce)](_0x96f373(0xa8), _0x44c782 => {
    window['innerWidth'] <= 0x300 && showChatPanel();
}), document[_0x96f373(0xb1)](_0x96f373(0x1be))[_0x96f373(0xce)]('click', _0x1cc837 => {
    window['innerWidth'] <= 0x300 && showUserListPanel();
});
const savedImage = localStorage[_0x96f373(0x162)](_0x96f373(0x148));
document[_0x96f373(0xf8)](_0x96f373(0x17b))[_0x96f373(0x100)] = savedImage || '/nihongo/img/user.png';
function showNotification(_0x32a4c0) {
    const _0x4d543a = _0x96f373, _0x144d9a = document[_0x4d543a(0xf3)](_0x4d543a(0x1ae));
    _0x144d9a[_0x4d543a(0xcf)] = _0x32a4c0, _0x144d9a[_0x4d543a(0x9d)][_0x4d543a(0x1a8)] = 'position:\x20fixed;\x20top:\x2070px;\x20right:\x2010px;\x20background:\x20#007bff;\x20color:\x20white;\x20padding:\x208px;\x20border-radius:\x204px;\x20z-index:\x201000;', document['body'][_0x4d543a(0x9e)](_0x144d9a), setTimeout(() => _0x144d9a[_0x4d543a(0x11f)](), 0xbb8);
}
async function generateKey() {
    const _0xf30875 = _0x96f373;
    if (sessionStorage[_0xf30875(0x162)](_0xf30875(0x193)))
        return;
    const _0x5c0232 = await crypto[_0xf30875(0x12e)]['generateKey']({
            'name': 'AES-GCM',
            'length': 0x100
        }, !![], [
            _0xf30875(0x140),
            _0xf30875(0x195)
        ]), _0xcbd994 = new Uint8Array(await crypto[_0xf30875(0x12e)][_0xf30875(0xc6)]('raw', _0x5c0232));
    sessionStorage[_0xf30875(0x168)](_0xf30875(0x193), JSON[_0xf30875(0x199)](Array[_0xf30875(0x173)](_0xcbd994)));
}
generateKey();
async function getKey() {
    const _0x39ee82 = _0x96f373, _0x5d32d0 = JSON['parse'](sessionStorage[_0x39ee82(0x162)]('encryptionKey')), _0x1c14f7 = new Uint8Array(_0x5d32d0);
    return await crypto[_0x39ee82(0x12e)]['importKey'](_0x39ee82(0x1a0), _0x1c14f7, { 'name': _0x39ee82(0xa7) }, !![], [
        _0x39ee82(0x140),
        'decrypt'
    ]);
}
async function encryptMessage(_0x282213) {
    const _0x15125a = _0x96f373, _0x57631c = await getKey(), _0x51da33 = crypto[_0x15125a(0xcd)](new Uint8Array(0xc)), _0x88a468 = new TextEncoder()[_0x15125a(0xde)](_0x282213), _0x1568b2 = await crypto[_0x15125a(0x12e)][_0x15125a(0x140)]({
            'name': _0x15125a(0xa7),
            'iv': _0x51da33
        }, _0x57631c, _0x88a468);
    return JSON['stringify']({
        'iv': Array[_0x15125a(0x173)](_0x51da33),
        'data': Array['from'](new Uint8Array(_0x1568b2))
    });
}
async function decryptMessage(_0x32f4c4) {
    const _0x2e48c2 = _0x96f373;
    try {
        const _0xc5bd72 = await getKey(), _0x3bb4ad = JSON[_0x2e48c2(0xd0)](_0x32f4c4), _0x505a1b = new Uint8Array(_0x3bb4ad['iv']), _0x16af2b = new Uint8Array(_0x3bb4ad[_0x2e48c2(0xbe)]), _0x1bb23b = await crypto[_0x2e48c2(0x12e)][_0x2e48c2(0x195)]({
                'name': _0x2e48c2(0xa7),
                'iv': _0x505a1b
            }, _0xc5bd72, _0x16af2b);
        return new TextDecoder()['decode'](_0x1bb23b);
    } catch (_0x5a19db) {
        return console[_0x2e48c2(0xe3)](_0x2e48c2(0x1c1), _0x5a19db), null;
    }
}
async function loadChatCache() {
    const _0x30afe0 = _0x96f373;
    showNotification(_0x30afe0(0x12b));
    let _0x1979bc = ![];
    for (let _0xb2bcd3 = 0x0; _0xb2bcd3 < localStorage[_0x30afe0(0x11d)]; _0xb2bcd3++) {
        const _0x57c05c = localStorage['key'](_0xb2bcd3);
        if (_0x57c05c[_0x30afe0(0xee)](_0x30afe0(0x1c0))) {
            const _0x396080 = _0x57c05c[_0x30afe0(0x130)]('_')[0x1], _0xf65a08 = localStorage[_0x30afe0(0x162)](_0x57c05c);
            if (_0xf65a08)
                try {
                    const _0x4f9475 = await Promise[_0x30afe0(0x96)](JSON[_0x30afe0(0xd0)](_0xf65a08)[_0x30afe0(0x1a9)](async _0x55eea0 => {
                        const _0x5362a1 = _0x30afe0, _0xa27bb7 = await decryptMessage(_0x55eea0);
                        if (_0xa27bb7 === null)
                            throw new Error(_0x5362a1(0xc8));
                        return JSON[_0x5362a1(0xd0)](_0xa27bb7);
                    }));
                    chatCache[_0x30afe0(0xea)](_0x396080, _0x4f9475);
                } catch (_0x4a53c6) {
                    console[_0x30afe0(0xe3)](_0x30afe0(0x13d) + _0x396080 + ':', _0x4a53c6), localStorage['removeItem'](_0x57c05c), console[_0x30afe0(0x1b6)](_0x30afe0(0x18f) + _0x396080), _0x1979bc = !![];
                }
        }
    }
    _0x1979bc ? showNotification(_0x30afe0(0xaa)) : showNotification(_0x30afe0(0xd7));
}
window['addEventListener'](_0x96f373(0x106), loadChatCache), document['addEventListener'](_0x96f373(0xd5), () => {
    const _0x5e5fc0 = _0x96f373, _0x5190d2 = document[_0x5e5fc0(0xf8)](_0x5e5fc0(0x183)), _0x191dce = document[_0x5e5fc0(0xf8)]('message-input'), _0x2c0a79 = document['getElementById'](_0x5e5fc0(0xfd)), _0x500eb7 = new EmojiMart['Picker']({
            'onEmojiSelect': _0x51ddaa => {
                const _0x160787 = _0x5e5fc0;
                _0x191dce[_0x160787(0x1ac)] += _0x51ddaa[_0x160787(0xdd)];
            },
            'theme': _0x5e5fc0(0x144)
        });
    _0x2c0a79['appendChild'](_0x500eb7), _0x5190d2[_0x5e5fc0(0xce)](_0x5e5fc0(0xa8), () => {
        const _0x1f1a3c = _0x5e5fc0;
        _0x2c0a79[_0x1f1a3c(0x97)]['toggle'](_0x1f1a3c(0x10f));
    }), document[_0x5e5fc0(0xce)]('click', _0x3d1ec1 => {
        const _0x31348b = _0x5e5fc0;
        !_0x2c0a79[_0x31348b(0x180)](_0x3d1ec1[_0x31348b(0xf2)]) && _0x3d1ec1[_0x31348b(0xf2)] !== _0x5190d2 && _0x2c0a79['classList'][_0x31348b(0x16c)](_0x31348b(0x10f));
    });
}), document[_0x96f373(0xf8)]('wallpaper-btn')[_0x96f373(0x1c6)] = function () {
    const _0x33503e = _0x96f373;
    document[_0x33503e(0xf8)](_0x33503e(0x176))[_0x33503e(0x9d)][_0x33503e(0x141)] = _0x33503e(0x19d);
};
function closeModal() {
    const _0xa5085b = _0x96f373;
    document['getElementById']('wallpaperModal')[_0xa5085b(0x9d)][_0xa5085b(0x141)] = _0xa5085b(0xf9);
}
function setChatBackground(_0x392285) {
    const _0x244ca1 = _0x96f373, _0x12218e = document[_0x244ca1(0xb1)](_0x244ca1(0x1ca));
    _0x12218e[_0x244ca1(0x9d)][_0x244ca1(0xed)] = _0x392285, _0x12218e[_0x244ca1(0x9d)][_0x244ca1(0x1c7)] = _0x244ca1(0x98), _0x12218e[_0x244ca1(0x9d)][_0x244ca1(0xd4)] = _0x244ca1(0x178), localStorage[_0x244ca1(0x168)](_0x244ca1(0xd2), _0x392285), closeModal();
}
function resetChatBackground() {
    const _0x16f593 = _0x96f373;
    document[_0x16f593(0xb1)](_0x16f593(0x1ca))[_0x16f593(0x9d)][_0x16f593(0xed)] = '', localStorage[_0x16f593(0xb3)](_0x16f593(0xd2)), closeModal();
}
window[_0x96f373(0x1cb)] = function () {
    const _0xb677a2 = _0x96f373;
    let _0x5d54fb = localStorage['getItem'](_0xb677a2(0xd2));
    if (_0x5d54fb) {
        let _0xb2cd13 = document[_0xb677a2(0xb1)](_0xb677a2(0x1ca));
        _0xb2cd13[_0xb677a2(0x9d)]['backgroundImage'] = _0x5d54fb, _0xb2cd13[_0xb677a2(0x9d)][_0xb677a2(0x1c7)] = _0xb677a2(0x98), _0xb2cd13[_0xb677a2(0x9d)][_0xb677a2(0xd4)] = _0xb677a2(0x178);
    }
}, document['addEventListener'](_0x96f373(0xd5), function () {
    const _0x2597a4 = _0x96f373, _0x65ef85 = document['getElementById'](_0x2597a4(0x165)), _0x4be001 = document[_0x2597a4(0xf8)]('blur-slider-container'), _0x1d59d1 = document[_0x2597a4(0xf8)](_0x2597a4(0x14e)), _0x4f304d = document[_0x2597a4(0xf8)]('blur-value'), _0x44801b = document[_0x2597a4(0xf8)](_0x2597a4(0x10d));
    let _0x10d6d7 = localStorage['getItem'](_0x2597a4(0x190)) || 0x5;
    document[_0x2597a4(0x172)][_0x2597a4(0x9d)][_0x2597a4(0x14c)](_0x2597a4(0x1c3), _0x10d6d7 + 'px'), _0x1d59d1[_0x2597a4(0x1ac)] = _0x10d6d7, _0x4f304d[_0x2597a4(0xcf)] = _0x10d6d7, _0x65ef85[_0x2597a4(0xce)](_0x2597a4(0xa8), function () {
        const _0x2ae920 = _0x2597a4;
        _0x4be001[_0x2ae920(0x9d)][_0x2ae920(0x141)] = _0x2ae920(0x19d);
    }), _0x1d59d1[_0x2597a4(0xce)](_0x2597a4(0x184), function () {
        const _0x144e55 = _0x2597a4;
        document['documentElement'][_0x144e55(0x9d)][_0x144e55(0x14c)](_0x144e55(0x1c3), this[_0x144e55(0x1ac)] + 'px'), _0x4f304d[_0x144e55(0xcf)] = this[_0x144e55(0x1ac)], localStorage[_0x144e55(0x168)](_0x144e55(0x190), this[_0x144e55(0x1ac)]);
    }), _0x44801b[_0x2597a4(0xce)](_0x2597a4(0xa8), function () {
        const _0x8173c8 = _0x2597a4;
        _0x4be001['style'][_0x8173c8(0x141)] = _0x8173c8(0xf9);
    });
});
function clearChatCacheCnf(_0x1e48fa) {
    const _0x353670 = _0x96f373;
    if (!confirm(_0x353670(0x135) + currentChatUsername + '?'))
        return;
    clearChatCache(_0x1e48fa);
}
function clearChatCache(_0x305864) {
    const _0x35002a = _0x96f373;
    chatCache[_0x35002a(0x146)](_0x305864) && chatCache[_0x35002a(0xbc)](_0x305864);
    const _0x156b70 = 'chat_' + _0x305864;
    localStorage['getItem'](_0x156b70) && localStorage[_0x35002a(0xb3)](_0x156b70);
    const _0xdbc491 = document[_0x35002a(0xf8)](_0x35002a(0x156));
    _0xdbc491[_0x35002a(0x1b3)] = '', showPopupMessage(_0x35002a(0x1ab) + currentChatUsername);
}
async function deleteChatHistory(_0x231397) {
    const _0x2d8b25 = _0x96f373;
    if (!_0x231397) {
        showPopupMessage2('Chat\x20user\x20ID\x20is\x20undefined.\x20Cannot\x20delete\x20chat\x20history.');
        return;
    }
    const _0x3a581c = confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20entire\x20chat\x20history?\x20This\x20action\x20cannot\x20be\x20undone.');
    if (!_0x3a581c)
        return;
    try {
        showPopupMessage2(_0x2d8b25(0x134), 0x2710, 'orange');
        const _0x846e69 = await apiRequest('/api/chats/delete/' + senderUserId + '/' + _0x231397, {
                'method': 'PUT',
                'headers': {
                    'Content-Type': _0x2d8b25(0x1a1),
                    'Authorization': _0x2d8b25(0x164) + localStorage[_0x2d8b25(0x162)]('accessToken')
                }
            }), _0x323c06 = await _0x846e69['json']();
        if (_0x846e69['ok']) {
            console[_0x2d8b25(0xcc)]('Chat\x20history\x20deleted\x20successfully:', _0x323c06), showPopupMessage2(_0x2d8b25(0x19e), 0xbb8, 'green');
            let _0xf02247 = JSON[_0x2d8b25(0xd0)](localStorage[_0x2d8b25(0x162)]('chattedUsers')) || [];
            _0xf02247 = _0xf02247[_0x2d8b25(0x139)](_0xc78113 => _0xc78113[_0x2d8b25(0x169)] !== _0x231397), localStorage['setItem']('chattedUsers', JSON[_0x2d8b25(0x199)](_0xf02247)), clearChatCache(currentChatUserId);
            const _0x22b17f = document['getElementById'](_0x2d8b25(0x156));
            _0x22b17f[_0x2d8b25(0x1b3)] = '', loadChatList(), socket[_0x2d8b25(0x187)](_0x2d8b25(0x128), { 'chatUserId': _0x231397 });
        } else
            console[_0x2d8b25(0xe3)](_0x2d8b25(0x15c), _0x323c06[_0x2d8b25(0xe3)]), alert(_0x2d8b25(0xda) + _0x323c06['error']);
    } catch (_0x4141dd) {
        showPopupMessage2(_0x2d8b25(0x143), 0x1388), console[_0x2d8b25(0xe3)]('Error\x20deleting\x20chat\x20history:', _0x4141dd);
    }
}
socket['on'](_0x96f373(0x1c2), ({
    senderUserId: _0x4f19c2,
    chatUserId: _0x8d4cbe
}) => {
    const _0x3ac49d = _0x96f373;
    console[_0x3ac49d(0xcc)](_0x3ac49d(0x118) + _0x4f19c2 + _0x3ac49d(0x120)), currentRoomId === _0x4f19c2 && (clearChatCache(currentRoomId), showPopupMessage(_0x3ac49d(0x118) + currentRoomName + _0x3ac49d(0x115)));
}), intializeSocket(), socket['on'](_0x96f373(0xe3), _0xfb92b => {
    const _0x1d7b4b = _0x96f373;
    console[_0x1d7b4b(0xe3)](_0x1d7b4b(0x12c), _0xfb92b);
});