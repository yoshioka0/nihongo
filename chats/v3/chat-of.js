const _0x2f771a = _0x29ec;
(function (_0x4c2cb5, _0x4427b5) {
    const _0xde654d = _0x29ec, _0x304e79 = _0x4c2cb5();
    while (!![]) {
        try {
            const _0x494f8d = -parseInt(_0xde654d(0x1e9)) / 0x1 * (parseInt(_0xde654d(0x1ad)) / 0x2) + parseInt(_0xde654d(0x1b6)) / 0x3 * (parseInt(_0xde654d(0x1ea)) / 0x4) + -parseInt(_0xde654d(0x1a0)) / 0x5 * (parseInt(_0xde654d(0x17c)) / 0x6) + parseInt(_0xde654d(0x1fc)) / 0x7 + -parseInt(_0xde654d(0x1b4)) / 0x8 + parseInt(_0xde654d(0x223)) / 0x9 * (parseInt(_0xde654d(0x1cd)) / 0xa) + parseInt(_0xde654d(0x1ae)) / 0xb * (parseInt(_0xde654d(0x1d0)) / 0xc);
            if (_0x494f8d === _0x4427b5)
                break;
            else
                _0x304e79['push'](_0x304e79['shift']());
        } catch (_0x1267d7) {
            _0x304e79['push'](_0x304e79['shift']());
        }
    }
}(_0x2a5d, 0x7576b), history[_0x2f771a(0x109)](null, null, location[_0x2f771a(0x1b1)]), window[_0x2f771a(0x165)] = function () {
    const _0x570450 = _0x2f771a;
    history[_0x570450(0x109)](null, null, location['href']);
});
let currentRoomId = null, currentRoomName = null, tokenexpired;
const token = getJWTToken();
function _0x2a5d() {
    const _0x605e0 = [
        'DMLZAwjPBgL0EwnOyw5Nzq',
        'qMvHCMvYia',
        'yxbWzw5Kq2HPBgq',
        'C2nYB2XSvg9W',
        '4PQG77IpifjLy29UBMvJDgLVBIbMywLSzwq6',
        'C2vHCMnOlxvZzxjZ',
        'vxnLCIbUB3qGzM91BMqGB3iGC2vYDMvYigvYCM9Y',
        'rxjYB3iGBwfYA2LUzYbTzxnZywDLCYbHCYbYzwfKoG',
        'CMvJB25Uzwn0x2vYCM9Y',
        'C3bHBG',
        'zNjVBq',
        'r0vu',
        'zMLSDgvY',
        'rxjYB3iGzMv0y2HPBMCGzNjVBsbZzxj2zxi6',
        'zgLZ',
        'sw52ywXPzcbYzxnWB25ZzsbMCM9TihnLCNzLCG',
        'C2v0',
        'Aw5WDxq',
        'y29U',
        'Dg9mB2nHBgveyxrLu3rYAw5N',
        'zgL2',
        'z2vUzxjHDgvlzxK',
        'sw52ywXPzcbYzxnWB25ZzsbMCM9TihnLCNzLCI4',
        'zhjVCgrVD24TBwvUDq',
        'rxjYB3iGyMXVy2TPBMCGDxnLCI4',
        'Dg9mB2nHBgvuAw1Lu3rYAw5N',
        'l2fWAs9JAgf0CY9IBg9JAY1ZDgf0DxmV',
        'ugLJA2vY',
        'Dgv4DenVBNrLBNq',
        '8j+uTcbtB2nRzxqGDw5KzwzPBMvKoIbmAwTLBhKGzhvLihrVihnVy2TLDcbPBML0AwfSAxnHDgLVBIbHC3LUy2HYB25VDxm',
        'yMXVy2S',
        'vxnLCIbPCYbuExbPBMCGlIaUic4',
        'y292zxi',
        're9nq29UDgvUDeXVywrLza',
        'DxnLCKLK',
        'B3bHy2L0EsaWlJnZigvHC2uTAw4TB3v0',
        'lMrYB3bKB3DUlwL0zw0',
        'ica8C3zNignSyxnZpsjHBMLTywWIihzPzxDcB3G9iJaGmcaXmdaWideWmdaIpJWVC3zNpGK',
        'vhLWAw5N',
        'qMXVy2S',
        'C29YDa',
        'Dgv4Da',
        'z3jLzw4',
        'yMvMB3jLDw5SB2fK',
        'y2HHDc11C2vY',
        'C2vZC2LVBI1LEhbPCMvK',
        't25SAw5L',
        'Bg9JyxrPB24',
        'tgfZDcbtzwvUoIa',
        'rgf0zvrPBwvgB3jTyxq',
        'rgvJCNLWDgLVBIbMywLSzwq',
        'rxjYB3iGy2HLy2TPBMCGyMXVy2SGC3rHDhvZoG',
        'l2fWAs9JAgf0CY9KzwXLDguV',
        'zw5JCNLWDa',
        'y2HHDfDHBgXWyxbLCG',
        'A2v5zg93BG',
        'q2HHDcbOAxn0B3j5igrLBgv0zwqGC3vJy2vZC2z1BgX5',
        'DxnLCLbYB2zPBgvqAwm',
        '8j+tQsbozxCGBwvZC2fNzsbMCM9Tia',
        'B3bHy2L0EsaWlJrZigvHC2uTB3v0lcb0CMfUC2zVCM0Gmc40CYbLyxnLlw91Da',
        'pha+tM8GBwvZC2fNzxmGEwv0lJWVCd4',
        'Aw1Hz2u',
        'pha+tM8GDxnLCNmGzM91BMqGBwf0y2HPBMCGEw91CIbXDwvYEs48l3a+',
        '4PQG77IpienVBM5Ly3rPB24GzMfPBgvKoG',
        'yNvZEq',
        '8j+BNcbszwnVBM5Ly3rLzcb0BYbZzxj2zxiSigf0DgvTChqGiW',
        'Dg9eyxrLu3rYAw5N',
        'C3rYAw5NAwz5',
        'yNv0Dg9U',
        'CMvZDwX0',
        'B25JBgLJAW',
        '4PYfienOyxqGq2fJAguGtg9HzgvKifn1y2nLC3nMDwXSEs4',
        'Dw5IBg9JA2vK',
        'u2vZC2LVBIbLEhbPCMvK',
        'y2XPzw50sgvPz2H0',
        'C3rHDhvZ',
        'y2vUDgvY',
        'rgvJCNLWDgLVBIbMywLSzwq6',
        'rxjYB3iGzgvSzxrPBMCGy2HHDcbOAxn0B3j5oG',
        'y3nZvgv4Da',
        'D2fSBhbHCgvYtw9KywW',
        'ue9tva',
        'rgvSzxrPBMCGq2HHDcbiAxn0B3j5lcbqBgvHC2uGv2fPDc4UlG',
        'DhLWAw5NlwLUzgLJyxrVCG',
        'C29JA2v0lxn0yxr1CW',
        'B25WB3bZDgf0zq',
        'zgf0yq',
        'z2v0rgf0zq',
        'CMvJzwL2zu1LC3nHz2u',
        'C2vUzgvY',
        'CMf3',
        'Cg9ZAxrPB246igzPEgvKoYb0B3a6idCWChG7igXLzNq6ideWChG7igjHy2TNCM91BMq6icmWmdDIzMy7ignVBg9YoIb3AgL0ztSGCgfKzgLUzZOGohb4oYbIB3jKzxiTCMfKAxvZoIa0ChG7ihOTAw5KzxG6ideWmda7',
        'C29JA2v0oG',
        'DxnLCKj1C3K',
        'tgfZDcbtzwvUoIbzzxn0zxjKyxKSia',
        'Aw1Hz2uTChjLDMLLDW',
        '8j+KR/cFPk/WN6sV',
        'D2fYBG',
        'yMfJA2DYB3vUza',
        'rxjYB3i6',
        'Dw5YzwfKlwnVBNrHAw5LCG',
        'D2fSBhbHCgvYlwj0BG',
        'yMfJA2DYB3vUzeLTywDL',
        'l2fWAs91CgXVywq',
        'qxjLihLVDsbZDxjLihLVDsb3yw50ihrVigrLBgv0zsb0AguGzw50AxjLignOyxqGAgLZDg9YEt8GvgHPCYbHy3rPB24Gy2fUBM90igjLihvUzg9Uzs4',
        'BxLHDMf0yxi',
        'B3jPz2LUywXuzxH0',
        'l25PAg9Uz28VBwvKAweVCg9WlM1WmW',
        'nde0qu9WAhPA',
        'DhjPBq',
        'rxjYB3iGC2vUzgLUzYbTzxnZywDLiq',
        'Aw1Hz2vvCMW',
        'rxjYB3i6ia',
        'DxnLCK9MzMXPBMu',
        'ls1IBhvYlxzHBhvL',
        'y2HHDeHPC3rVCNLezwXLDgvK',
        'q2fUy2vSBgvKiq',
        'yMfJA2DYB3vUzfnPEMu',
        'yxbWzw5K',
        'DhjHBNnMB3jT',
        'l25PAg9Uz28VAw1Nl3vZzxiUCg5N',
        'Aw5Uzxjive1m',
        'BNvTzxjPyW',
        'ls12Aa',
        'rxjYB3i6ie5VihvZzxiGC2vSzwn0zwqGDg8GyMXVy2SU',
        'BwfYA0fZuMvHza',
        'Dg9mB3DLCKnHC2u',
        'DgLTzxn0yw1W',
        'rNvUy3rPB24GDw5HDMfPBgfIBguHie1LC3nHz2uGBM90igrLBgv0zwqGAxrZigP1C3qGysbKzw1VlG',
        'yMX1CI1ZBgLKzxiTy29UDgfPBMvY',
        'l2fWAs9JAgf0CY9TyxjRlxjLywq',
        'lMjHy2STyNrU',
        'rxjYB3iGDxbKyxrPBMCGBwvZC2fNzsbJywnOztO',
        'zMLSzxm',
        'rxjYB3iGBg9HzgLUzYbJAgf0ig1LC3nHz2vZoG',
        'l2fWAs9JAgf0CY9OAxn0B3j5lW',
        'rMfPBgvKihrVigrLBgv0zsbJAgf0igHPC3rVCNK6',
        'zw4Tvvm',
        'Bg9N',
        'l2fWAs9JAgf0CY9JAgf0DgvKlxvZzxjZ',
        'BgfUz3vHz2u',
        'Aw1WB3j0s2v5',
        'Aw1N',
        'qxjLihLVDsbZDxjLihLVDsb3yw50ihrVia',
        'mtqYmdbXs2HWB3O',
        'l2fWAs9JAgf0CY91C2vYCZ91C2vYBMfTzt0',
        'zw1VAMKTCgLJA2vY',
        'Bwf0y2HLCW',
        'C2vSzG',
        'zxjYB3i',
        'Aw1Hz2uTChjLDMLLDY1JB250ywLUzxi',
        'BwvZC2fNzq',
        'zM9YBwf0',
        'C3rYAw5N',
        'AgfZ',
        'lMnOyxqTD2LUzg93',
        'q2HHDcbJywnOzsbJBgvHCMvKigzVCIb1C2vYia',
        'mJrxruTLuMO',
        'mti5ode5ofnhtu9zAq',
        'yMXVy2STyNv0Dg9U',
        'rxjYB3iGDxbKyxrPBMCGC2vYDMvYoG',
        'AhjLzG',
        'zxHW',
        'Aw5UzxjxAwr0Aa',
        'nJi3ndmXmKXjsMPMrG',
        '8j+FOIbszwnVBM5Ly3rLza',
        'mtq2mtiXAfHPwKz3',
        '4PQG77IpifnVy2TLDcbKAxnJB25Uzwn0zwq6',
        'lMnOyxqTy29UDgfPBMvY',
        'zgLZCgXHEq',
        'y2HHBMDL',
        'Dg9Nz2XL',
        'B3jHBMDL',
        'B3bHy2L0Eq',
        'pgKGy2XHC3m9iMzHlxnVBgLKigzHlxrYyxnOiJ48l2K+',
        'C2HVDW',
        'BMv3twvZC2fNzu5VDgLMAwnHDgLVBG',
        'sM9PBIbLBwL0igzHAwXLzcb0BYbZB2nRzxqGD2L0Acb1C2vYoG',
        'quvtluDdtq',
        'y2XPy2S',
        'z2v0sxrLBq',
        'C2v0sxrLBq',
        'BgvHDMvsB29T',
        'C2vUze1LC3nHz2u',
        'y29UDgfPBNm',
        'C2vUzgvYtMfTzq',
        'CMvHzc1YzwnLAxb0',
        'ywXS',
        'BwvZC2fNzs1PBNb1Da',
        'mtaYmZiWtMjwrhrK',
        'u2vZC2LVBIbfEhbPCMvK',
        'pha+u2vHCMnOihf1zxj5igXLBMD0AcbTDxn0igjLid49idm8l3a+',
        'mJrABeDfBgq',
        'y2XHC3nmAxn0',
        'BgfZDefJDgL2zq',
        'AM9PBG',
        'BMv3twvZC2fNzq',
        'z2v0tw9UDgG',
        'rMfPBgvKihrVigrLy3j5ChqGy2HHDcbMB3iG',
        'yMX1CI1IDg4',
        'cGKGicaGicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iNr5CgLUzY1KB3rZiJ4kcsaGicaGicaGicaGicaGicaGicaGicaGidXZCgfUpJWVC3bHBJ48C3bHBJ48l3nWyw4+phnWyw4+pc9ZCgfUpGOjicaGicaGicaGicaGicaGicaGica8l2rPDJ4kcsaGicaGicaGicaGicaGica',
        'zM9YrwfJAa',
        'zxHWB3j0s2v5',
        'zMXLEa',
        'y3jLyxrLrwXLBwvUDa',
        'y2HHDc13Aw5KB3C',
        'ywrK',
        '4PQG77IpierPC2nVBM5Ly3rLza',
        'C3r5Bgu',
        'z2v0',
        'z2v0rwXLBwvUDej5swq',
        'zgvSzxrLlwj1DhrVBG',
        'CgfYC2u',
        'AgLKzgvU',
        'C2vHCMnOugfYyw1Z',
        'ievYCM9YihvWzgf0Aw5Nig1LC3nHz2uGy2fJAgu6ia',
        'CMvTB3zL',
        'nZa3mtHkBwLmv08',
        'ndbMr1bPrM8',
        'pgrPDIbJBgfZCZ0Iy2HHDc1TzxnZywDLCYi+pc9KAxy+',
        '8j+tQsbmB2fKzwqG',
        'rxjYB3iGy2HLy2TPBMCGDxnLCIbHDMfPBgfIAwXPDhK6',
        'BgvUz3rO',
        'x2jSyw5R',
        'AxnszwfK',
        'CMvTB3zLsxrLBq',
        'C3vIDgXL',
        'BwvZC2fNzxnszwfK',
        'AxncBg9JA2vK',
        'l2fWAs9JAgf0CY9ZyxzLlwnOyxr0zwqTDxnLCG',
        'yMfJA2DYB3vUzfbVC2L0Aw9U',
        'ufvu',
        '8j+sRca',
        'rxjYB3iGyMXVy2TPBMCGDxnLCJO',
        'DhLWAw5N',
        '4PQG77Ipie5VignOyxqGC2vSzwn0zwqGDg8GCMvMCMvZAc4',
        'ndm3ntu3ngDYBhjPDW',
        'DgfYz2v0',
        '8j+BNcbtB2nRzxqGy29UBMvJDgvKihrVihrOzsbZzxj2zxiGD2L0AcbjrdO',
        'BxLvC2vYBMfTzq',
        'y2HHDhrLzfvZzxjZ',
        'yMX1CI1ZBgLKzxi',
        'y29UBMvJDf9LCNjVCG',
        'C2v0uhjVCgvYDhK',
        'l2fWAs9JAgf0CY9HDMfPBgfIAwXPDhKV',
        'zw5JCNLWDgLVBKTLEq',
        'zMXVB3i',
        'w2rHDgeTDxnLCI1Pzd0N',
        'sfruucbLCNjVCIeGu3rHDhvZoIa',
        'y2HHDc1PBwfNzq',
        'twvZC2fNzxmGBwfYA2vKigfZihjLywq6',
        'y2HHDf8',
        'C3jJ',
        'igHHCYbIzwvUigrLBgv0zwqGyNKGDgHLig90AgvYihvZzxiU',
        'y2fUy2vSlxbYzxzPzxC',
        'B2zMBgLUzq',
        'Dg9tDhjPBMC',
        'vxnLCIbjrcbVCIbvC2vYBMfTzsbPCYbTAxnZAw5NlIbtA2LWCgLUzY4',
        '8j+BNcbdB25Uzwn0zwq',
        'yM9KEq',
        'DMfSDwu',
        'BwfW',
        'EwvSBg93',
        'ANnVBG',
        'CxvLCNLtzwXLy3rVCKfSBa',
        't2zMBgLUzq',
        'zg9JDw1LBNrfBgvTzw50',
        'C29Tzq',
        'y2HHDejSDxi',
        'zw5JB2rL',
        'zgvJCNLWDa',
        'x2LK',
        'rxjYB3iGC2vUzgLUzYbTzxnZywDLoG',
        'zw1PDa',
        'zgvSzxrL',
        'odq2CuzKv0jL',
        'CxvLCNLtzwXLy3rVCG',
        'CMvJzwL2zxi',
        'w0LTywDLxq',
        'ig1PC3nPBMCGBwvZC2fNzxmU',
        'y2XVC2uTyMX1CI1ZBgLKzxi',
        'rxjYB3i',
        'Bg9Hza',
        'yMXVy2STDxnLCG',
        'Aw1Hz2uTBg9HzgvY',
        'rMfPBgvKihrVig1HCMSGBwvZC2fNzxmGyxmGCMvHzdO',
        'pgGXpLnLC3nPB24GrxHWAxjLzcWGuMvMCMvZAcb0AguGCgfNzs48l2GXpGOjcqKjcqKjcqKjcqK8Aw1Nihn0EwXLpsjOzwLNAhq6mJaWChG7ihDPzhrOoJiWmhb4oYbWB3nPDgLVBJPHyNnVBhv0ztSGDg9WoJuWjtSGBgvMDdO1mcu7ihrYyw5ZzM9YBtP0CMfUC2XHDguOltuWjsWGltuWjsK7iIbZCMm9iI9UAwHVBMDVl2LTzY9Py29UlNbUzYiGlZ4j',
        'idXKAxyGy2XHC3m9iMXVywrLCI1JB250ywLUzxiIpIa8zgL2ignSyxnZpsjSB2fKzxiIpJWVzgL2pIa8C3bHBJ5mB2fKAw5NienOyxrZlI4Upc9ZCgfUpIa8l2rPDJ4j',
        'zgLZy29UBMvJDa',
        'y29SB3i',
        'AxnbCNjHEq',
        'B25SB2fK',
        'qxjLihLVDsbZDxjLihLVDsb3yw50ihrVihnLBMqGDgHLigLTywDLpW',
        'C3rHCNrZv2L0Aa',
        'l25PAg9Uz28VBwvKAweVBM90AwzPy2f0Aw9UlM1WmW',
        'zgf0yxnLDa',
        'z2v0uMfUzg9TvMfSDwvZ',
        'BgLNAhq',
        'CMvHzefZrgf0yvvsta',
        'ywrKrxzLBNrmAxn0zw5LCG',
        'C2nYB2XSsgvPz2H0',
        'vxnLCIbPCYbcDxn5',
        'qwnJzxnZigrLBMLLzc4',
        'DhjHBNnPDgLVBG',
        'rxjYB3iGDxbSB2fKAw5NigLTywDLoG',
        'Aw1Hz2uTAw5WDxq',
        'C2vZC2LVBI1Hy3rPDMu',
        'z2v0rNvSBfLLyxi',
        'i0reodzgrG',
        'zw1VAMKTyNv0Dg9U',
        'mI1KAwDPDa',
        'u29JA2v0ignVBM5Ly3rPB24GzMfPBgvKlcb0CNKGywDHAw4GBgf0zxiU',
        'ihjLywqGBwvZC2fNzxmGAw4Gy2HHDca',
        'C2HVDY1JAgf0',
        'DxnLCM5HBwu',
        'DhjHBNnSyxrLwsGXmhb4kq',
        'CMvJB25Uzwn0',
        '8j+BNcbszwnVBM5Ly3rLzcaOqxr0zw1WDca',
        'Aw5JBhvKzxm',
        'DxbKyxrLze1LC3nHz2vZ',
        'q2HHDcb1C2vYieLeigLZihvUzgvMAw5Lzc4Gq2fUBM90igrLBgv0zsbJAgf0igHPC3rVCNKU',
        'yMXVy2TLza',
        'yxbWBgLJyxrPB24VANnVBG',
        'zM9UDfDLAwDODa',
        'C3bSAxq',
        'rxjYB3i6iezPBguGC2L6zsbLEgnLzwrLzcbVCIbIywqGCMvXDwvZDhm',
        'ChvZAa',
        'vxnLCIa',
        'vw5IBg9JAW',
        'q2HHDcbOAxn0B3j5igrLBgv0zwqGC3vJy2vZC2z1BgX5oG',
        'B3rOzxi',
        'BM9Uzq',
        'B25SAw5L',
        'zgvJB2rL',
        'qxjLihLVDsbZDxjLihLVDsb3yw50ihrVignSzwfYihrOzsbJAgf0ignHy2HLigzVCIa',
        'qNvZEq',
        'ChvZAfn0yxrL',
        'i2nOyxqTBgLZDa',
        'ywnJzxnZvg9Rzw4',
        '8j+uKsbmB2fKAw5NievUy3j5ChrLzcbdAgf0ienHy2HLlI4U',
        'ywX0',
        'q2HHDcbOAxn0B3j5ihDPDgGG',
        'BM9YBwfS'
    ];
    _0x2a5d = function () {
        return _0x605e0;
    };
    return _0x2a5d();
}
if (token) {
    const decodedToken = JSON[_0x2f771a(0x1e4)](atob(token['split']('.')[0x1])), expiryTime = decodedToken[_0x2f771a(0x1b2)] * 0x3e8;
    startCountdown(expiryTime);
} else
    console[_0x2f771a(0x19a)]('No\x20token\x20found');
function startCountdown(_0x4929a0) {
    const _0x359444 = document['getElementById']('countdown'), _0x5d7f29 = setInterval(() => {
            const _0x5d5b00 = _0x29ec, _0x2a5575 = Date['now'](), _0x1de5e1 = _0x4929a0 - _0x2a5575;
            if (_0x1de5e1 <= 0x0)
                clearInterval(_0x5d7f29), _0x359444[_0x5d5b00(0x12c)] = _0x5d5b00(0x159), _0x359444[_0x5d5b00(0x1d1)][_0x5d5b00(0x1e8)]('session-active'), _0x359444[_0x5d5b00(0x1d1)][_0x5d5b00(0x1de)](_0x5d5b00(0x13d)), showPopupMessage('Session\x20Expired'), tokenexpired = !![];
            else {
                const _0x14e97d = Math[_0x5d5b00(0x206)](_0x1de5e1 / 0xea60), _0x4f10df = Math[_0x5d5b00(0x206)](_0x1de5e1 % 0xea60 / 0x3e8);
                _0x359444[_0x5d5b00(0x12c)] = '⏰\x20' + _0x14e97d + ':' + (_0x4f10df < 0xa ? '0' : '') + _0x4f10df, _0x359444[_0x5d5b00(0x1d1)][_0x5d5b00(0x1e8)]('session-expired'), _0x359444[_0x5d5b00(0x1d1)]['add'](_0x5d5b00(0xeb));
            }
        }, 0x3e8);
}
const accessToken = localStorage[_0x2f771a(0x1c4)](_0x2f771a(0x10b)), socket = io(SOCKET_URL, { 'auth': { 'token': localStorage[_0x2f771a(0x1c4)]('accessToken') } });
socket['on']('connect', () => {
    const _0x3f7910 = _0x2f771a;
    console[_0x3f7910(0x19a)](_0x3f7910(0x1fe), socket['id']), document['getElementById'](_0x3f7910(0x164))[_0x3f7910(0x12c)] = _0x3f7910(0x212), document[_0x3f7910(0x1e2)](_0x3f7910(0x164))[_0x3f7910(0x1d1)][_0x3f7910(0x1e8)](_0x3f7910(0x122), _0x3f7910(0x11e)), document[_0x3f7910(0x1e2)](_0x3f7910(0x164))[_0x3f7910(0x1d1)][_0x3f7910(0x1de)](_0x3f7910(0x122)), currentRoomId && currentRoomName && (showPopupMessage2(_0x3f7910(0x1b5), 0x7d0, _0x3f7910(0x13a)), joinRoom(currentRoomId, currentRoomName));
});
const searchUser = document[_0x2f771a(0x1e2)](_0x2f771a(0x115)), chatList = document[_0x2f771a(0x1e2)]('chat-list'), chatWindow = document[_0x2f771a(0x1e2)]('chat-window'), messageInput = document[_0x2f771a(0x1e2)](_0x2f771a(0x1cc)), sendButton = document[_0x2f771a(0x1e2)]('send-button'), logoutButton = document[_0x2f771a(0x1e2)]('logoutBtn'), blockButton = document['getElementById'](_0x2f771a(0x1af)), chatUserElement = document[_0x2f771a(0x1e2)](_0x2f771a(0x13c)), lastActiveElement = document['getElementById'](_0x2f771a(0x15b)), userElement2 = chatUserElement, loader = document['getElementById'](_0x2f771a(0x22c)), decoded = decodeJWT(accessToken), senderUserId = decoded[_0x2f771a(0x132)], senderUsername = decoded[_0x2f771a(0xf3)];
document[_0x2f771a(0x1e2)](_0x2f771a(0x1ff))[_0x2f771a(0x12c)] = senderUsername;
async function fetchAPI(_0x16fca6, _0x9628a3 = _0x2f771a(0x11b), _0x4f1ec0 = null) {
    const _0x503cc6 = _0x2f771a, _0x388758 = {
            'Content-Type': _0x503cc6(0xfb),
            'Authorization': _0x503cc6(0x111) + accessToken
        }, _0x4a41c2 = {
            'method': _0x9628a3,
            'headers': _0x388758
        };
    if (_0x4f1ec0)
        _0x4a41c2[_0x503cc6(0x213)] = JSON[_0x503cc6(0x153)](_0x4f1ec0);
    const _0x46f7dd = await apiRequest('' + _0x16fca6, _0x4a41c2);
    if (!_0x46f7dd['ok'])
        throw new Error(await _0x46f7dd[_0x503cc6(0x139)]());
    return _0x46f7dd[_0x503cc6(0x217)]();
}
const url = new URL(self[_0x2f771a(0x13f)]['href']), queryParam = url[_0x2f771a(0x1e6)][_0x2f771a(0x1e1)](_0x2f771a(0xf3));
let query = null;
queryParam && (query = queryParam, searchUser['value'] = query, loadChatList(query));
let debounceTimeout;
function searchUsers() {
    const _0x158aa5 = _0x2f771a, _0x434710 = document[_0x158aa5(0x1e2)](_0x158aa5(0x115))[_0x158aa5(0x214)][_0x158aa5(0x17d)]();
    clearTimeout(debounceTimeout), debounceTimeout = setTimeout(() => {
        loadChatList(_0x434710);
    }, 0x1f4);
}
let currentChatUserId = null;
async function loadChatList(_0x478c7d = '') {
    const _0x3ef784 = _0x2f771a;
    try {
        chatList[_0x3ef784(0x189)] = '';
        const _0x8b42d9 = JSON[_0x3ef784(0x1e4)](localStorage['getItem'](_0x3ef784(0x200))) || [], _0x39a259 = document['createElement']('hr'), _0x4f126b = document[_0x3ef784(0x1dc)]('hr'), _0x155b06 = new Set(_0x8b42d9['map'](_0x48b459 => _0x48b459[_0x3ef784(0x132)]));
        let _0x14fb2e = [], _0x31c733 = new Set();
        console['log']('🔴🟢🟠\x20Loaded\x20Chatted\x20Users\x20matching\x20query'), _0x8b42d9[_0x3ef784(0x1d9)](({
            username: _0x1b381d,
            userId: _0x402fc1
        }) => {
            const _0x5b9e3e = _0x3ef784;
            if (_0x1b381d[_0x5b9e3e(0x18e)]()[_0x5b9e3e(0xf7)](_0x478c7d['toLowerCase']())) {
                const _0x45384b = createUserItem(_0x1b381d, _0x402fc1);
                chatList[_0x5b9e3e(0x112)](_0x45384b), _0x31c733[_0x5b9e3e(0x1de)](_0x402fc1);
            }
        }), chatList[_0x3ef784(0x112)](_0x39a259);
        if (_0x478c7d) {
            if (_0x478c7d[_0x3ef784(0x1ee)] < 0x3) {
                chatList[_0x3ef784(0x189)] = _0x3ef784(0x1cf);
                return;
            }
            const _0x435302 = await fetchAPI(_0x3ef784(0x1a1) + _0x478c7d);
            _0x435302[_0x3ef784(0x1ee)] === 0x0 && (chatList[_0x3ef784(0x189)] = _0x3ef784(0x14e)), _0x14fb2e = _0x435302[_0x3ef784(0x11c)](_0x18a67e => !_0x155b06[_0x3ef784(0x1aa)](_0x18a67e[_0x3ef784(0x21f)])), _0x14fb2e['forEach'](_0x136bbc => {
                const _0x30adf8 = _0x3ef784, _0x3762a4 = createUserItem(_0x136bbc[_0x30adf8(0xf3)], _0x136bbc['_id']);
                chatList[_0x30adf8(0x112)](_0x3762a4);
            }), _0x14fb2e[_0x3ef784(0x1ee)] > 0x0 && chatList[_0x3ef784(0x112)](_0x4f126b);
        }
        !_0x478c7d && _0x8b42d9[_0x3ef784(0x1d9)](({
            username: _0x3f1467,
            userId: _0x373af2
        }) => {
            const _0x300063 = _0x3ef784;
            if (!_0x31c733[_0x300063(0x1aa)](_0x373af2)) {
                const _0x2ab119 = createUserItem(_0x3f1467, _0x373af2);
                chatList[_0x300063(0x112)](_0x2ab119);
            }
        });
    } catch (_0x223d55) {
        chatList['innerHTML'] = '<p>No\x20users\x20found\x20matching\x20your\x20query</p>', console[_0x3ef784(0x1a5)]('Error\x20loading\x20chat\x20list:', _0x223d55['message']);
    }
}
function createUserItem(_0x3b53d7, _0x43f552) {
    const _0x194eae = _0x2f771a, _0x370df6 = document[_0x194eae(0x1dc)](_0x194eae(0x124));
    return _0x370df6['textContent'] = _0x3b53d7, _0x370df6['classList']['add']('user-item'), _0x370df6[_0x194eae(0xe0)][_0x194eae(0x132)] = _0x43f552, _0x370df6[_0x194eae(0xe4)](_0x194eae(0x1c3), () => openChat(_0x43f552, _0x3b53d7)), _0x370df6;
}
function joinRoom(_0x4f7ab6, _0x41f9ff) {
    const _0x2a0e13 = _0x2f771a;
    currentRoomId && socket[_0x2a0e13(0x221)]('leaveRoom', { 'currentChatUserId': currentRoomId }), currentRoomId = _0x4f7ab6, currentRoomName = _0x41f9ff, socket[_0x2a0e13(0x221)](_0x2a0e13(0x1d3), { 'recipientUserId': _0x4f7ab6 });
}
const chatCache = new Map();
chatWindow[_0x2f771a(0x189)] = _0x2f771a(0x135);
async function openChat(_0x5e67d0, _0x6e1079) {
    const _0x48e6b0 = _0x2f771a;
    console[_0x48e6b0(0x19a)](_0x5e67d0, _0x6e1079), currentChatUserId = _0x5e67d0, currentChatUsername = _0x6e1079, searchUser['value'] = null, saveUser(currentChatUserId, currentChatUsername), loadChatList(), document[_0x48e6b0(0x1e2)](_0x48e6b0(0x13c))[_0x48e6b0(0x12c)] = _0x48e6b0(0x1f8) + _0x6e1079;
    if (tokenexpired) {
        showPopupMessage(_0x48e6b0(0x1ce)), chatWindow[_0x48e6b0(0x189)] = '<h1>Session\x20Expired,\x20Refresh\x20the\x20page.</h1>\x0a\x09\x09\x09\x09\x09\x09\x09\x09\x09\x09\x09\x09<img\x20style=\x22height:200px;\x20width:200px;\x20position:absolute;\x20top:50%;\x20left:50%;\x20transform:translate(-50%,\x20-50%);\x22\x20src=\x22/nihongo/img/icon.png\x22\x20/>\x09';
        return;
    }
    chatWindow[_0x48e6b0(0x189)] = _0x48e6b0(0x22f), joinRoom(_0x5e67d0, _0x6e1079);
    if (chatCache[_0x48e6b0(0x1aa)](_0x5e67d0))
        renderMessages(chatCache[_0x48e6b0(0x1e1)](_0x5e67d0));
    else
        try {
            let _0x341018 = [];
            const _0x24f6e9 = localStorage[_0x48e6b0(0x1c4)](_0x48e6b0(0x20b) + _0x5e67d0);
            if (_0x24f6e9)
                _0x341018 = await Promise[_0x48e6b0(0x1cb)](JSON['parse'](_0x24f6e9)[_0x48e6b0(0x215)](async _0x561d67 => JSON[_0x48e6b0(0x1e4)](await decryptMessage(_0x561d67))));
            else {
                _0x341018 = await fetchAPI(_0x48e6b0(0x197) + senderUserId + '/' + _0x5e67d0);
                const _0x1d0db9 = await Promise[_0x48e6b0(0x1cb)](_0x341018['map'](_0x2cf984 => encryptMessage(JSON[_0x48e6b0(0x153)](_0x2cf984))));
                localStorage['setItem'](_0x48e6b0(0x20b) + _0x5e67d0, JSON[_0x48e6b0(0x153)](_0x1d0db9));
            }
            chatCache['set'](_0x5e67d0, _0x341018), renderMessages(_0x341018);
        } catch (_0x23c331) {
            console[_0x48e6b0(0x1a5)](_0x48e6b0(0x196), _0x23c331['message']), chatMessagesContainer[_0x48e6b0(0x189)] = '<p>Error\x20loading\x20messages.\x20Please\x20try\x20again\x20later.</p>';
        }
    checkUserAvailability(currentChatUserId), socket[_0x48e6b0(0x221)](_0x48e6b0(0x18d), {
        'senderId': senderUserId,
        'receiverId': currentChatUserId
    }), updateBlockButton();
}
async function renderMessages(_0x1ddd11) {
    const _0x5cf8a4 = _0x2f771a;
    chatWindow[_0x5cf8a4(0x189)] = _0x5cf8a4(0x1eb);
    const _0x34111e = chatWindow[_0x5cf8a4(0x224)]('.chat-messages');
    _0x34111e[_0x5cf8a4(0x189)] = _0x1ddd11[_0x5cf8a4(0x1ee)] ? '' : _0x5cf8a4(0x14c);
    for (const _0x5cb07a of _0x1ddd11) {
        const _0xca9370 = _0x5cb07a[_0x5cf8a4(0x169)][_0x5cf8a4(0x21f)] === senderUserId;
        displayMessage(_0x5cb07a, _0xca9370);
    }
    refreshChat();
}
async function saveUser(_0x1c9788, _0x331965) {
    const _0x52ea33 = _0x2f771a;
    if (!_0x1c9788 || !_0x331965) {
        console[_0x52ea33(0x171)](_0x52ea33(0x211));
        return;
    }
    let _0x94b7bf = JSON[_0x52ea33(0x1e4)](localStorage[_0x52ea33(0x1c4)](_0x52ea33(0x200))) || [];
    !_0x94b7bf['some'](_0x28f877 => _0x28f877[_0x52ea33(0x132)] === _0x1c9788) && (_0x94b7bf[_0x52ea33(0xff)]({
        'userId': _0x1c9788,
        'username': _0x331965
    }), localStorage[_0x52ea33(0x1c5)](_0x52ea33(0x200), JSON['stringify'](_0x94b7bf)));
    try {
        const _0xe4c345 = await apiRequest(_0x52ea33(0x1f5), {
                'method': _0x52ea33(0x161),
                'headers': {
                    'Content-Type': _0x52ea33(0xfb),
                    'Authorization': _0x52ea33(0x111) + localStorage['getItem']('accessToken')
                },
                'body': JSON['stringify']({ 'currentChatUserId': _0x1c9788 })
            }), _0x797624 = await _0xe4c345['json']();
        console['log'](_0x797624['message']);
    } catch (_0x427c30) {
        console[_0x52ea33(0x1a5)](_0x52ea33(0x1b0), _0x427c30), showPopupMessage(_0x427c30);
    }
}
async function getChattedUsers() {
    const _0x4b6f36 = _0x2f771a;
    let _0x3dcc18 = JSON[_0x4b6f36(0x1e4)](localStorage[_0x4b6f36(0x1c4)](_0x4b6f36(0x200)));
    if (!_0x3dcc18 || _0x3dcc18[_0x4b6f36(0x1ee)] === 0x0)
        try {
            const _0x1f4d90 = await apiRequest(_0x4b6f36(0x19b), {
                    'method': _0x4b6f36(0x11b),
                    'headers': { 'Authorization': 'Bearer\x20' + localStorage[_0x4b6f36(0x1c4)]('accessToken') }
                }), _0x547ec9 = await _0x1f4d90[_0x4b6f36(0x217)]();
            _0x547ec9[_0x4b6f36(0x200)] && (_0x3dcc18 = _0x547ec9[_0x4b6f36(0x200)]['map'](_0x38d559 => ({
                'userId': _0x38d559[_0x4b6f36(0x21f)],
                'username': _0x38d559['username']
            })), localStorage[_0x4b6f36(0x1c5)](_0x4b6f36(0x200), JSON[_0x4b6f36(0x153)](_0x3dcc18)), loadChatList());
        } catch (_0x366da1) {
            console[_0x4b6f36(0x1a5)](_0x4b6f36(0x11d), _0x366da1);
        }
    else
        loadChatList();
}
document[_0x2f771a(0xe4)](_0x2f771a(0x131), getChattedUsers);
async function appendMessages(_0x1176ef) {
    const _0x2ac852 = _0x2f771a, _0x29bfe6 = document[_0x2ac852(0x1dc)](_0x2ac852(0x124));
    _0x29bfe6[_0x2ac852(0x189)] = '<hr\x20class=\x22unread-divider\x22><span\x20class=\x22unread-text\x22>Unread\x20Messages</span>', _0x29bfe6['classList'][_0x2ac852(0x1de)](_0x2ac852(0x174)), chatWindow['appendChild'](_0x29bfe6);
    for (const _0x1569ab of _0x1176ef) {
        if (typeof _0x1569ab[_0x2ac852(0x169)] === _0x2ac852(0x1a9))
            _0x1569ab[_0x2ac852(0x169)] = { '_id': _0x1569ab['sender'] };
        if (typeof _0x1569ab[_0x2ac852(0x225)] === _0x2ac852(0x1a9))
            _0x1569ab[_0x2ac852(0x225)] = { '_id': _0x1569ab[_0x2ac852(0x225)] };
        const _0x4c6814 = _0x1569ab['sender'][_0x2ac852(0x21f)] === senderUserId;
        displayMessage(_0x1569ab, _0x4c6814);
    }
    chatWindow[_0x2ac852(0xe5)] - chatWindow[_0x2ac852(0x113)] <= chatWindow[_0x2ac852(0x15a)] + 0x32 && (chatWindow[_0x2ac852(0x113)] = chatWindow['scrollHeight']);
}
async function refreshChat() {
    const _0xc2eed9 = _0x2f771a;
    if (!currentChatUserId) {
        showAlert(_0xc2eed9(0x1fb));
        return;
    }
    showNotification('🔄\x20Checking\x20for\x20missing\x20messages\x20...');
    try {
        const _0x1057ac = await fetchAPI(_0xc2eed9(0x197) + senderUserId + '/' + currentChatUserId);
        if (!Array[_0xc2eed9(0xdb)](_0x1057ac))
            throw new Error(_0xc2eed9(0x126));
        const _0x25dd1b = chatCache['get'](currentChatUserId) || [], _0x3a962e = _0x1057ac[_0xc2eed9(0x11c)](_0x483dec => !_0x25dd1b[_0xc2eed9(0x21b)](_0x4a3c59 => _0x4a3c59[_0xc2eed9(0x21f)] === _0x483dec[_0xc2eed9(0x21f)])), _0x3863d3 = _0x3a962e[_0xc2eed9(0x11c)](_0x52d576 => !document['querySelector']('[data-message-id=\x22' + _0x52d576['_id'] + '\x22]'));
        if (_0x3863d3[_0xc2eed9(0x1ee)] === 0x0) {
            showNotification('✅\x20Chat\x20is\x20up\x20to\x20date\x20with\x20' + currentChatUsername);
            return;
        }
        const _0x17a7a3 = [
            ..._0x25dd1b,
            ..._0x3863d3
        ][_0xc2eed9(0x138)]((_0x4ecf1f, _0x2a4922) => new Date(_0x4ecf1f[_0xc2eed9(0x18f)]) - new Date(_0x2a4922[_0xc2eed9(0x18f)]));
        chatCache['set'](currentChatUserId, _0x17a7a3);
        const _0x54c9c9 = await Promise[_0xc2eed9(0x1cb)](_0x17a7a3[_0xc2eed9(0x215)](_0x58cb62 => encryptMessage(JSON[_0xc2eed9(0x153)](_0x58cb62))));
        localStorage[_0xc2eed9(0x1c5)](_0xc2eed9(0x20b) + currentChatUserId, JSON[_0xc2eed9(0x153)](_0x54c9c9)), appendMessages(_0x3863d3), showNotification(_0xc2eed9(0x1ec) + _0x3863d3[_0xc2eed9(0x1ee)] + _0xc2eed9(0x227));
    } catch (_0x138105) {
        console['error']('❌\x20Error\x20refreshing\x20chat:', _0x138105), showNotification('⚠️\x20Failed\x20to\x20refresh\x20chat.');
    }
}
function displayMessage(_0x161474, _0x5a814b) {
    const _0x2b5dad = _0x2f771a, _0x468fa2 = document[_0x2b5dad(0x1dc)](_0x2b5dad(0x124));
    _0x468fa2[_0x2b5dad(0x1d1)][_0x2b5dad(0x1de)](_0x2b5dad(0x1a7), _0x5a814b ? _0x2b5dad(0x1a4) : _0x2b5dad(0x103)), _0x468fa2[_0x2b5dad(0xe0)][_0x2b5dad(0x17a)] = _0x161474[_0x2b5dad(0x1a7)], _0x468fa2[_0x2b5dad(0xe0)][_0x2b5dad(0x19c)] = detectLanguage(_0x161474[_0x2b5dad(0x1a7)]);
    const _0x19ccf4 = document[_0x2b5dad(0x1dc)](_0x2b5dad(0x154));
    _0x19ccf4[_0x2b5dad(0x1d1)][_0x2b5dad(0x1de)](_0x2b5dad(0x1e3)), _0x19ccf4['innerHTML'] = _0x2b5dad(0x1be), _0x19ccf4[_0x2b5dad(0x156)] = () => confirmDelete(_0x468fa2);
    const _0x364950 = new Date(_0x161474['timestamp'])[_0x2b5dad(0x123)]([], {
            'year': 'numeric',
            'month': 'short',
            'day': 'numeric'
        }), _0x521f8e = new Date(_0x161474[_0x2b5dad(0x18f)])[_0x2b5dad(0x129)]([], {
            'hour': _0x2b5dad(0xef),
            'minute': _0x2b5dad(0xef),
            'second': _0x2b5dad(0xef)
        }), _0x488d84 = _0x364950 + ',\x20' + _0x521f8e, _0x1e26bc = document[_0x2b5dad(0x1dc)](_0x2b5dad(0x119));
    _0x1e26bc[_0x2b5dad(0x1d1)]['add']('timestamp'), _0x1e26bc[_0x2b5dad(0x12c)] = _0x488d84;
    const _0x3edf8c = document[_0x2b5dad(0x1dc)](_0x2b5dad(0x119));
    _0x3edf8c[_0x2b5dad(0x1d1)][_0x2b5dad(0x1de)](_0x2b5dad(0x1ca));
    _0x5a814b && (_0x3edf8c['textContent'] = _0x161474[_0x2b5dad(0x1f0)] ? '✔✔' : '✔');
    if (_0x161474['type'] === _0x2b5dad(0x14d)) {
        const _0x23943a = document[_0x2b5dad(0x1dc)](_0x2b5dad(0x19e));
        _0x23943a[_0x2b5dad(0x20c)] = _0x161474['fileUrl'], _0x23943a[_0x2b5dad(0x1d1)]['add'](_0x2b5dad(0x209)), _0x23943a[_0x2b5dad(0x10d)] = 'Sent\x20Image', _0x23943a['onclick'] = () => window['open'](_0x161474['fileUrl'], _0x2b5dad(0x1ef)), _0x468fa2['appendChild'](_0x23943a);
    } else {
        const _0x31e9f0 = document[_0x2b5dad(0x1dc)]('p');
        _0x31e9f0[_0x2b5dad(0x12c)] = _0x161474[_0x2b5dad(0x1a7)], _0x468fa2[_0x2b5dad(0x112)](_0x31e9f0);
    }
    _0x468fa2['appendChild'](_0x19ccf4), _0x468fa2['appendChild'](_0x1e26bc), _0x468fa2['appendChild'](_0x3edf8c), chatWindow[_0x2b5dad(0x112)](_0x468fa2), chatWindow[_0x2b5dad(0x113)] = chatWindow[_0x2b5dad(0xe5)], updateMessages();
}
function confirmDelete(_0x38c221) {
    const _0x128f6f = _0x2f771a;
    confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20message?') && (_0x38c221[_0x128f6f(0x1e8)](), showPopupMessage2(_0x128f6f(0x190)));
}
function intializeSocket() {
    const _0x5bfa7b = _0x2f771a;
    if (socket) {
        sendButton[_0x5bfa7b(0xe4)]('click', _0x1b131b), messageInput[_0x5bfa7b(0xe4)](_0x5bfa7b(0x147), _0x24476a => {
            if (_0x24476a['key'] === 'Enter')
                _0x1b131b();
        });
        const _0x129770 = document['getElementById']('image-button'), _0x317eed = document[_0x5bfa7b(0x1e2)](_0x5bfa7b(0xea)), _0x3c9796 = document['getElementById'](_0x5bfa7b(0x1a6)), _0x563dff = document[_0x5bfa7b(0x1e2)](_0x5bfa7b(0x16f)), _0x515d1e = document[_0x5bfa7b(0x1e2)](_0x5bfa7b(0x20e));
        let _0x1943a7 = null;
        _0x129770['addEventListener'](_0x5bfa7b(0x1c3), () => {
            const _0x55229b = _0x5bfa7b;
            _0x317eed[_0x55229b(0x1c3)]();
        }), _0x515d1e[_0x5bfa7b(0xe4)](_0x5bfa7b(0x1c3), () => {
            const _0x332e1d = _0x5bfa7b;
            _0x1943a7 = null, _0x3c9796['style'][_0x332e1d(0x1b9)] = _0x332e1d(0x104), _0x317eed['value'] = '';
        }), _0x317eed['addEventListener'](_0x5bfa7b(0x1ba), _0x1b40dd => {
            const _0x236c53 = _0x5bfa7b, _0xa19fa5 = _0x1b40dd[_0x236c53(0x1fd)][_0x236c53(0x195)][0x0];
            if (_0xa19fa5) {
                _0x1943a7 = _0xa19fa5;
                const _0x5e47ac = new FileReader();
                _0x5e47ac[_0x236c53(0xdc)] = _0xf0965d => {
                    const _0x1908a8 = _0x236c53;
                    _0x563dff['src'] = _0xf0965d[_0x1908a8(0x1fd)][_0x1908a8(0x155)], _0x3c9796[_0x1908a8(0x1e0)][_0x1908a8(0x1b9)] = _0x1908a8(0x12e);
                }, _0x5e47ac[_0x236c53(0xe3)](_0xa19fa5);
            }
        });
        async function _0x1b131b() {
            const _0x1d3d61 = _0x5bfa7b;
            if (!currentChatUserId)
                return;
            if (tokenexpired) {
                showPopupMessage(_0x1d3d61(0x1ce)), chatWindow[_0x1d3d61(0x189)] = _0x1d3d61(0x22e);
                return;
            }
            let _0x329572 = null;
            const _0x4dc85d = messageInput['value'][_0x1d3d61(0x17d)]();
            if (_0x4dc85d) {
                const _0x31a808 = {
                    'senderUsername': senderUsername,
                    'receiver': currentChatUserId,
                    'message': _0x4dc85d,
                    'type': _0x1d3d61(0x139)
                };
                try {
                    socket['emit'](_0x1d3d61(0x1c7), _0x31a808, _0x143bf9 => {
                        const _0x4a7955 = _0x1d3d61;
                        messageInput[_0x4a7955(0x214)] = '', _0x143bf9?.['error'] && showAlert(_0x4a7955(0x17e), _0x143bf9[_0x4a7955(0x1a5)]);
                    });
                } catch (_0x3af212) {
                    console[_0x1d3d61(0x1a5)](_0x1d3d61(0x220), _0x3af212['message']);
                }
            }
            if (_0x1943a7) {
                const _0xa92cfe = await showConfirmBox(_0x1d3d61(0xdd));
                if (!_0xa92cfe)
                    return showPopupMessage2(_0x1d3d61(0x184));
                showNotification('Uploading\x20image...'), loader[_0x1d3d61(0x1e0)]['display'] = _0x1d3d61(0x12e);
                try {
                    const _0x1e9975 = new FormData();
                    _0x1e9975[_0x1d3d61(0x186)](_0x1d3d61(0x14d), _0x1943a7);
                    const _0x272dbd = await apiRequest(_0x1d3d61(0x177), {
                            'method': 'POST',
                            'headers': { 'Authorization': _0x1d3d61(0x111) + localStorage[_0x1d3d61(0x1c4)](_0x1d3d61(0x10b)) },
                            'body': _0x1e9975
                        }), _0x1be24a = await _0x272dbd['json']();
                    if (!_0x1be24a[_0x1d3d61(0x17f)]) {
                        showNotification('Image\x20upload\x20failed!'), loader[_0x1d3d61(0x1e0)]['display'] = _0x1d3d61(0x104), showPopupMessage(_0x1be24a[_0x1d3d61(0x1a7)] || _0x1d3d61(0xe7));
                        return;
                    }
                    _0x1be24a?.[_0x1d3d61(0x1a5)] && (loader['style'][_0x1d3d61(0x1b9)] = _0x1d3d61(0x104), showAlert(_0x1d3d61(0x173), _0x1be24a[_0x1d3d61(0x1a5)]));
                    _0x329572 = _0x1be24a[_0x1d3d61(0x17f)];
                    const _0x4186f8 = {
                        'senderUsername': senderUsername,
                        'receiver': currentChatUserId,
                        'message': _0x1d3d61(0x226),
                        'type': _0x1d3d61(0x14d),
                        'fileUrl': _0x329572
                    };
                    socket[_0x1d3d61(0x221)](_0x1d3d61(0x1c7), _0x4186f8, _0x5f04db => {
                        const _0x139689 = _0x1d3d61;
                        _0x5f04db?.['error'] && showAlert(_0x139689(0x229), _0x5f04db[_0x139689(0x1a5)]);
                    }), _0x1943a7 = null, loader[_0x1d3d61(0x1e0)][_0x1d3d61(0x1b9)] = _0x1d3d61(0x104), _0x3c9796[_0x1d3d61(0x1e0)][_0x1d3d61(0x1b9)] = _0x1d3d61(0x104), _0x317eed[_0x1d3d61(0x214)] = '';
                } catch (_0x32d331) {
                    loader[_0x1d3d61(0x1e0)]['display'] = _0x1d3d61(0x104), showNotification(_0x1d3d61(0xfe)), console[_0x1d3d61(0x1a5)](_0x1d3d61(0xe9), _0x32d331[_0x1d3d61(0x1a7)]);
                }
            }
        }
        socket['on'](_0x5bfa7b(0x168), async _0x3a9c17 => {
            const _0x20291d = _0x5bfa7b;
            if (!_0x3a9c17 || !_0x3a9c17[_0x20291d(0x169)] || !_0x3a9c17[_0x20291d(0x225)])
                return;
            _0x32679d(_0x3a9c17), _0x3a9c17[_0x20291d(0x169)] === currentChatUserId || _0x3a9c17[_0x20291d(0x225)] === currentChatUserId ? (_0x1d86a3[_0x20291d(0x1e0)][_0x20291d(0x1b9)] = _0x20291d(0x104), displayMessage(_0x3a9c17, _0x3a9c17[_0x20291d(0x169)] === senderUserId), _0x3a9c17[_0x20291d(0x169)] !== senderUserId && playAudio(_0x20291d(0xdf))) : console['log']('Message\x20not\x20related\x20to\x20current\x20window,\x20ignored');
        }), socket['on'](_0x5bfa7b(0x1c0), _0x22a161 => {
            const _0x1c15e6 = _0x5bfa7b;
            showNotification2(_0x1c15e6(0x14a) + _0x22a161[_0x1c15e6(0x1c9)] + ':\x20' + _0x22a161[_0x1c15e6(0x1d4)][_0x1c15e6(0x1a7)], 0x1b58), playAudio(_0x1c15e6(0x17b)), _0x32679d(_0x22a161[_0x1c15e6(0x1d4)]);
        });
        async function _0x32679d(_0x24e0f4) {
            const _0x1cd311 = _0x5bfa7b;
            try {
                const _0x1c3389 = {
                        ..._0x24e0f4,
                        'sender': { '_id': _0x24e0f4[_0x1cd311(0x169)] },
                        'receiver': { '_id': _0x24e0f4['receiver'] }
                    }, _0x2c968b = _0x24e0f4['sender'] === senderUserId ? _0x24e0f4[_0x1cd311(0x225)] : _0x24e0f4[_0x1cd311(0x169)], _0x2981bf = chatCache['get'](_0x2c968b) || [];
                if (_0x1c3389[_0x1cd311(0x21f)] && !_0x2981bf[_0x1cd311(0x21b)](_0xccf3fc => _0xccf3fc[_0x1cd311(0x21f)] === _0x1c3389[_0x1cd311(0x21f)])) {
                    const _0x4d4c75 = [
                        ..._0x2981bf,
                        _0x1c3389
                    ];
                    chatCache[_0x1cd311(0x120)](_0x2c968b, _0x4d4c75);
                    const _0x156c90 = await Promise['all'](_0x4d4c75[_0x1cd311(0x215)](_0x2800ba => encryptMessage(JSON['stringify'](_0x2800ba))));
                    localStorage[_0x1cd311(0x1c5)](_0x1cd311(0x20b) + _0x2c968b, JSON[_0x1cd311(0x153)](_0x156c90));
                }
            } catch (_0xea5e5d) {
                showAlert(_0x1cd311(0x1e7), _0xea5e5d[_0x1cd311(0x1a7)]), console[_0x1cd311(0x1a5)](_0x1cd311(0x194), _0xea5e5d);
            }
        }
        let _0x59de6b, _0x3d4e62 = !![];
        const _0x1d86a3 = document[_0x5bfa7b(0x1e2)](_0x5bfa7b(0x163));
        messageInput['addEventListener']('input', () => {
            const _0x2cf688 = _0x5bfa7b;
            currentChatUserId && senderUserId !== currentChatUserId && (_0x3d4e62 && socket && (socket[_0x2cf688(0x221)](_0x2cf688(0x1fa), {
                'senderId': senderUserId,
                'receiverId': currentChatUserId
            }), _0x3d4e62 = ![], setTimeout(() => {
                _0x3d4e62 = !![];
            }, 0x5dc)), clearTimeout(_0x59de6b));
        }), socket && socket['on'](_0x5bfa7b(0x1fa), ({senderId: _0x59c620}) => {
            const _0x93ed7c = _0x5bfa7b;
            _0x59c620 !== senderUserId && currentChatUserId === _0x59c620 && (updateStatus(_0x93ed7c(0x136)), _0x1d86a3[_0x93ed7c(0x1e0)][_0x93ed7c(0x1b9)] !== 'flex' && (_0x1d86a3[_0x93ed7c(0x1e0)]['display'] = _0x93ed7c(0x1db), _0x1d86a3[_0x93ed7c(0x189)] = _0x93ed7c(0x1d8)), clearTimeout(_0x59de6b), _0x59de6b = setTimeout(() => {
                const _0x4aeda6 = _0x93ed7c;
                updateStatus(_0x4aeda6(0x13e)), _0x1d86a3[_0x4aeda6(0x1e0)][_0x4aeda6(0x1b9)] = _0x4aeda6(0x104);
            }, 0xbb8));
        }), document[_0x5bfa7b(0xe4)](_0x5bfa7b(0x110), () => {
            const _0x5e26e5 = _0x5bfa7b;
            socket && (document[_0x5e26e5(0x1e5)] ? socket[_0x5e26e5(0x221)](_0x5e26e5(0x16d), { 'senderUserId': senderUserId }) : (senderId = senderUserId, receiverId = currentChatUserId, senderUserId && receiverId && socket[_0x5e26e5(0x221)](_0x5e26e5(0x18d), {
                'senderId': senderId,
                'receiverId': receiverId
            }), socket[_0x5e26e5(0x221)]('userOnline', { 'senderUserId': senderUserId })));
        }), window['addEventListener'](_0x5bfa7b(0x13b), () => {
            const _0x3e9976 = _0x5bfa7b;
            socket && socket[_0x3e9976(0x221)](_0x3e9976(0x181), { 'senderUserId': senderUserId });
        }), socket['on']('userOnline', ({senderUserId: _0x2f7f66}) => {
            const _0x12d6d9 = _0x5bfa7b;
            userId = _0x2f7f66;
            const _0x19837b = document[_0x12d6d9(0x224)](_0x12d6d9(0x207) + userId + '\x27]');
            _0x19837b ? (_0x19837b['classList'][_0x12d6d9(0x1e8)](_0x12d6d9(0x20f), _0x12d6d9(0x150), _0x12d6d9(0x105)), _0x19837b['classList'][_0x12d6d9(0x1de)](_0x12d6d9(0x105))) : _0x12d6d9(0x170), userElement2 && currentChatUserId === _0x2f7f66 && (userElement2[_0x12d6d9(0x1d1)][_0x12d6d9(0x1e8)]('offline', _0x12d6d9(0x150), _0x12d6d9(0x105)), userElement2[_0x12d6d9(0x1d1)][_0x12d6d9(0x1de)](_0x12d6d9(0x105)), updateStatus(_0x12d6d9(0x13e)));
        }), socket['on'](_0x5bfa7b(0x181), ({senderUserId: _0x2d6b5e}) => {
            const _0x46086e = _0x5bfa7b;
            updateStatus(_0x46086e(0x219)), userId = _0x2d6b5e;
            const _0x4354c6 = document[_0x46086e(0x224)](_0x46086e(0x207) + userId + '\x27]');
            _0x4354c6 && (_0x4354c6[_0x46086e(0x1d1)]['remove'](_0x46086e(0x20f), _0x46086e(0x150), 'online'), _0x4354c6['classList'][_0x46086e(0x1de)]('offline')), userElement2 && currentChatUserId === _0x2d6b5e && (userElement2[_0x46086e(0x1d1)]['remove']('offline', 'busy', 'online'), userElement2[_0x46086e(0x1d1)][_0x46086e(0x1de)](_0x46086e(0x20f)), checkUserAvailability(currentChatUserId));
        }), socket['on'](_0x5bfa7b(0x16d), ({senderUserId: _0x5e7142}) => {
            const _0x38ed15 = _0x5bfa7b;
            userId = _0x5e7142;
            const _0x299ef1 = document[_0x38ed15(0x224)](_0x38ed15(0x207) + userId + '\x27]');
            _0x299ef1 && (_0x299ef1[_0x38ed15(0x1d1)][_0x38ed15(0x1e8)](_0x38ed15(0x20f), _0x38ed15(0x150), _0x38ed15(0x105)), _0x299ef1[_0x38ed15(0x1d1)][_0x38ed15(0x1de)](_0x38ed15(0x150))), userElement2 && currentChatUserId === _0x5e7142 && (userElement2[_0x38ed15(0x1d1)]['remove']('offline', 'busy', _0x38ed15(0x105)), userElement2[_0x38ed15(0x1d1)][_0x38ed15(0x1de)](_0x38ed15(0x150)), updateStatus('Busy'));
        }), socket['on'](_0x5bfa7b(0x1f3), _0x3f8084 => {
            const _0x1185c6 = _0x5bfa7b, {
                    chatId: _0xe40385,
                    readerId: _0x1593d4
                } = _0x3f8084;
            currentChatUserId === _0x1593d4 && senderUserId === _0xe40385 && (console[_0x1185c6(0x19a)](_0x1185c6(0x100) + _0x1593d4 + _0x1185c6(0xf1) + _0xe40385), lol());
        });
    } else
        console[_0x5bfa7b(0x19a)](_0x5bfa7b(0x16c), socket), console[_0x5bfa7b(0x19a)](_0x5bfa7b(0x12d));
    socket['on'](_0x5bfa7b(0xd9), _0xc3c95d => {
        const _0x4ed72e = _0x5bfa7b;
        console[_0x4ed72e(0x19a)](_0x4ed72e(0x1b7), _0xc3c95d), document[_0x4ed72e(0x1e2)](_0x4ed72e(0x164))['textContent'] = _0x4ed72e(0x1df), document['getElementById'](_0x4ed72e(0x164))[_0x4ed72e(0x1d1)][_0x4ed72e(0x1e8)](_0x4ed72e(0x122), 'dis'), document[_0x4ed72e(0x1e2)](_0x4ed72e(0x164))[_0x4ed72e(0x1d1)][_0x4ed72e(0x1de)](_0x4ed72e(0x11e));
    }), socket['on'](_0x5bfa7b(0x202), _0x4e86a6 => {
        const _0x37600a = _0x5bfa7b;
        console['error'](_0x37600a(0x14f), _0x4e86a6), document[_0x37600a(0x1e2)](_0x37600a(0x164))[_0x37600a(0x12c)] = '⚠️\x20Connection\x20Failed', document['getElementById'](_0x37600a(0x164))[_0x37600a(0x1d1)]['remove'](_0x37600a(0x122), 'dis'), document['getElementById']('socket-status')[_0x37600a(0x1d1)]['add'](_0x37600a(0x11e));
    }), socket['on'](_0x5bfa7b(0xf5), _0x1f109b => {
        const _0x5a1e43 = _0x5bfa7b;
        console['log'](_0x5a1e43(0x151) + _0x1f109b), document['getElementById']('socket-status')[_0x5a1e43(0x12c)] = _0x5a1e43(0xf6) + _0x1f109b + ')', document[_0x5a1e43(0x1e2)](_0x5a1e43(0x164))[_0x5a1e43(0x1d1)]['remove']('con', _0x5a1e43(0x11e)), document[_0x5a1e43(0x1e2)](_0x5a1e43(0x164))[_0x5a1e43(0x1d1)]['add']('con');
    }), socket['on'](_0x5bfa7b(0x118), _0x4aaa73 => {
        const _0x3c2aa3 = _0x5bfa7b;
        console[_0x3c2aa3(0x1a5)](_0x3c2aa3(0x114), _0x4aaa73), document[_0x3c2aa3(0x1e2)]('socket-status')[_0x3c2aa3(0x12c)] = '⚠️\x20Reconnection\x20Failed', document[_0x3c2aa3(0x1e2)](_0x3c2aa3(0x164))[_0x3c2aa3(0x1d1)][_0x3c2aa3(0x1e8)]('con', _0x3c2aa3(0x11e)), document[_0x3c2aa3(0x1e2)](_0x3c2aa3(0x164))[_0x3c2aa3(0x1d1)][_0x3c2aa3(0x1de)]('dis');
    });
}
async function toggleBlockUser() {
    const _0xde96b9 = _0x2f771a;
    if (!currentChatUserId) {
        showPopupMessage2('Error:\x20No\x20user\x20selected\x20to\x20block.');
        return;
    }
    const _0x2dc140 = blockButton[_0xde96b9(0xe0)][_0xde96b9(0xfa)] === 'true', _0x26c481 = _0x2dc140 ? 'unblock-user' : _0xde96b9(0x22b);
    if (!confirm(_0xde96b9(0x19f) + _0x26c481 + '\x20' + currentChatUsername + '?'))
        return;
    try {
        const _0x137e04 = {
                'blockUserId': currentChatUserId,
                'unblockUserId': currentChatUserId
            }, _0x46c69c = await apiRequest('/api/chats/' + _0x26c481, {
                'method': _0xde96b9(0x161),
                'headers': {
                    'Content-Type': _0xde96b9(0xfb),
                    'Authorization': _0xde96b9(0x111) + localStorage[_0xde96b9(0x1c4)]('accessToken')
                },
                'body': JSON['stringify'](_0x137e04)
            }), _0x3a639c = await _0x46c69c['json']();
        _0x46c69c['ok'] ? (blockButton[_0xde96b9(0x12c)] = _0x2dc140 ? _0xde96b9(0x137) : _0xde96b9(0x101), blockButton[_0xde96b9(0xe0)][_0xde96b9(0xfa)] = !_0x2dc140, socket[_0xde96b9(0x221)](_0xde96b9(0x1c6), { 'currentChatUserId': currentChatUserId }), showPopupMessage(currentChatUsername + '\x20has\x20been\x20' + (_0x2dc140 ? _0xde96b9(0x158) : _0xde96b9(0xfa)) + '.'), _0x2dc140 && (recipientUserId = currentChatUserId, socket ? socket[_0xde96b9(0x221)]('join', { 'recipientUserId': recipientUserId }) : console[_0xde96b9(0x1a5)](_0xde96b9(0x1c1), recipientUserId))) : showAlert(_0xde96b9(0x229), _0x3a639c['error'] || _0xde96b9(0x128));
    } catch (_0x21cfe4) {
        console[_0xde96b9(0x1a5)](_0xde96b9(0x1f9), _0x21cfe4[_0xde96b9(0x1a7)]);
    }
}
async function markMessagesssssAsRead(_0x407517, _0x4f27d3) {
    const _0x4afa97 = _0x2f771a;
    try {
        const _0x50592f = await apiRequest(_0x4afa97(0x192), {
                'method': 'PATCH',
                'headers': {
                    'Content-Type': _0x4afa97(0xfb),
                    'Authorization': _0x4afa97(0x111) + localStorage['getItem'](_0x4afa97(0x10b))
                },
                'body': JSON['stringify']({
                    'senderId': senderUserId,
                    'receiverId': currentChatUserId
                })
            }), _0x1e80c7 = await _0x50592f['json']();
        _0x50592f['ok'] ? (console[_0x4afa97(0x19a)](_0x4afa97(0x20a), _0x1e80c7[_0x4afa97(0xf8)]), io['to'](_0x407517)['emit'](_0x4afa97(0x1f3), {
            'readerId': readerId,
            'chatId': chatId
        })) : console['error'](_0x4afa97(0x22d), _0x1e80c7['error']);
    } catch (_0x4c6acc) {
        console[_0x4afa97(0x1a5)](_0x4afa97(0x117), _0x4c6acc);
    }
}
async function updateBlockButton() {
    const _0x41f4e6 = _0x2f771a;
    if (!currentChatUserId) {
        showPopupMessage(_0x41f4e6(0x18c));
        return;
    }
    try {
        const _0x2badbb = await apiRequest(_0x41f4e6(0x12a) + currentChatUserId, {
            'method': 'GET',
            'headers': { 'Authorization': _0x41f4e6(0x111) + localStorage[_0x41f4e6(0x1c4)]('accessToken') }
        });
        if (!_0x2badbb['ok'])
            throw new Error(_0x41f4e6(0x208) + _0x2badbb['status']);
        const _0x56e63c = await _0x2badbb[_0x41f4e6(0x217)]();
        if (typeof _0x56e63c[_0x41f4e6(0x1f4)] === 'undefined')
            throw new Error(_0x41f4e6(0x11f));
        blockButton[_0x41f4e6(0x12c)] = _0x56e63c['isBlocked'] ? _0x41f4e6(0x101) : _0x41f4e6(0x137), blockButton[_0x41f4e6(0xe0)][_0x41f4e6(0xfa)] = _0x56e63c[_0x41f4e6(0x1f4)][_0x41f4e6(0x210)]();
    } catch (_0x4cbb1e) {
        console[_0x41f4e6(0x1a5)](_0x41f4e6(0x143), _0x4cbb1e), blockButton[_0x41f4e6(0x1e0)][_0x41f4e6(0x1b9)] = 'none';
    }
}
function toggleDropdown() {
    const _0x38a9af = _0x2f771a, _0x324286 = document[_0x38a9af(0x1e2)](_0x38a9af(0x127));
    _0x324286[_0x38a9af(0x1d1)][_0x38a9af(0x1c8)](_0x38a9af(0x1bf)) ? (_0x324286[_0x38a9af(0x1d1)]['remove'](_0x38a9af(0x1bf)), setTimeout(() => _0x324286[_0x38a9af(0x1e0)][_0x38a9af(0x1b9)] = _0x38a9af(0x104), 0xc8)) : (_0x324286[_0x38a9af(0x1e0)][_0x38a9af(0x1b9)] = _0x38a9af(0x12e), setTimeout(() => _0x324286[_0x38a9af(0x1d1)][_0x38a9af(0x1de)](_0x38a9af(0x1bf)), 0xa));
}
document[_0x2f771a(0xe4)](_0x2f771a(0x1c3), function (_0xefb1d1) {
    const _0x113df6 = _0x2f771a, _0x3e97a3 = document['getElementById'](_0x113df6(0x127)), _0x507856 = document['getElementById']('more-btn');
    !_0x507856[_0x113df6(0x1c8)](_0xefb1d1[_0x113df6(0x1fd)]) && !_0x3e97a3[_0x113df6(0x1c8)](_0xefb1d1[_0x113df6(0x1fd)]) && (_0x3e97a3[_0x113df6(0x1d1)][_0x113df6(0x1e8)](_0x113df6(0x1bf)), setTimeout(() => _0x3e97a3[_0x113df6(0x1e0)][_0x113df6(0x1b9)] = 'none', 0xc8));
}), document[_0x2f771a(0x1e2)]('dropdown-menu')['addEventListener'](_0x2f771a(0x1c3), function (_0x468ef3) {
    const _0x165a49 = _0x2f771a, _0x46ec7e = document['getElementById']('dropdown-menu');
    _0x468ef3[_0x165a49(0x1fd)][_0x165a49(0x1a3)](_0x165a49(0x134)) && (_0x46ec7e[_0x165a49(0x1d1)]['remove']('show'), setTimeout(() => _0x46ec7e['style'][_0x165a49(0x1b9)] = _0x165a49(0x104), 0xc8));
});
async function checkUserAvailability(_0x24437b) {
    const _0x3cf0e8 = _0x2f771a;
    try {
        const _0x420d4d = await apiRequest(_0x3cf0e8(0x204) + _0x24437b, {
            'method': _0x3cf0e8(0x11b),
            'headers': { 'Authorization': _0x3cf0e8(0x111) + localStorage[_0x3cf0e8(0x1c4)](_0x3cf0e8(0x10b)) }
        });
        if (!_0x420d4d['ok'])
            throw new Error(_0x3cf0e8(0x116));
        const _0x1bb6f2 = await _0x420d4d[_0x3cf0e8(0x217)]();
        _0x1bb6f2['isOnline'] ? (updateStatus(_0x3cf0e8(0x13e)), chatUserElement[_0x3cf0e8(0x1d1)]['add'](_0x3cf0e8(0x105)), chatUserElement[_0x3cf0e8(0x1d1)][_0x3cf0e8(0x1e8)](_0x3cf0e8(0x20f))) : (chatUserElement[_0x3cf0e8(0x1d1)][_0x3cf0e8(0x1de)](_0x3cf0e8(0x20f)), chatUserElement[_0x3cf0e8(0x1d1)][_0x3cf0e8(0x1e8)]('online'));
        if (lastActiveElement) {
            if (chatUserElement[_0x3cf0e8(0x1d1)][_0x3cf0e8(0x1c8)](_0x3cf0e8(0x20f))) {
                const _0x568a5b = new Date(_0x1bb6f2[_0x3cf0e8(0x1d2)]), _0x7b9587 = new Date(), _0x2c6eca = _0x568a5b[_0x3cf0e8(0x129)](_0x3cf0e8(0x199), {
                        'hour': _0x3cf0e8(0xef),
                        'minute': _0x3cf0e8(0xef),
                        'hour12': !![]
                    }), _0x25e502 = new Intl[(_0x3cf0e8(0x141))]([], {
                        'year': _0x3cf0e8(0x18a),
                        'month': '2-digit',
                        'day': '2-digit'
                    }), _0x59be6b = _0x568a5b[_0x3cf0e8(0x152)]() === _0x7b9587[_0x3cf0e8(0x152)](), _0x3910e6 = _0x568a5b[_0x3cf0e8(0x167)]() === _0x7b9587[_0x3cf0e8(0x167)]() - 0x1 && _0x568a5b[_0x3cf0e8(0x1d5)]() === _0x7b9587[_0x3cf0e8(0x1d5)]() && _0x568a5b['getFullYear']() === _0x7b9587[_0x3cf0e8(0xec)]();
                let _0x634aed;
                if (_0x59be6b)
                    _0x634aed = 'Last\x20Seen:\x20' + _0x2c6eca;
                else
                    _0x3910e6 ? _0x634aed = _0x3cf0e8(0x16e) + _0x2c6eca : _0x634aed = _0x3cf0e8(0x140) + _0x25e502[_0x3cf0e8(0x1a8)](_0x568a5b) + '\x20' + _0x2c6eca;
                lastActiveElement['textContent'] = _0x634aed;
            }
        }
    } catch (_0x2a4fc0) {
        console[_0x3cf0e8(0x1a5)](_0x3cf0e8(0x1ed), _0x2a4fc0);
    }
}
function updateStatus(_0xaabea1) {
    const _0x37282f = _0x2f771a;
    lastActiveElement[_0x37282f(0x1e0)][_0x37282f(0xe8)] = _0x37282f(0x133), lastActiveElement[_0x37282f(0x1e0)][_0x37282f(0x1bd)] = '0', setTimeout(() => {
        const _0x54e003 = _0x37282f;
        if (_0xaabea1 === _0x54e003(0x13e))
            lastActiveElement[_0x54e003(0x12c)] = _0x54e003(0x13e), lastActiveElement['style'][_0x54e003(0xda)] = _0x54e003(0x13a), lastActiveElement['style'][_0x54e003(0xfc)] = 'bold';
        else {
            if (_0xaabea1 === _0x54e003(0x108))
                lastActiveElement[_0x54e003(0x12c)] = _0x54e003(0xe6), lastActiveElement[_0x54e003(0x1e0)]['color'] = _0x54e003(0x216), lastActiveElement['style']['fontWeight'] = _0x54e003(0x10f);
            else {
                if (_0xaabea1 === _0x54e003(0x219))
                    lastActiveElement[_0x54e003(0x12c)] = _0x54e003(0x219), lastActiveElement['style'][_0x54e003(0xda)] = 'red', lastActiveElement[_0x54e003(0x1e0)][_0x54e003(0xfc)] = 'normal';
                else
                    _0xaabea1 === _0x54e003(0x136) && (lastActiveElement[_0x54e003(0x12c)] = _0x54e003(0x12f), lastActiveElement['style'][_0x54e003(0xda)] = _0x54e003(0xed), lastActiveElement[_0x54e003(0x1e0)][_0x54e003(0xfc)] = _0x54e003(0x10f));
            }
        }
        lastActiveElement['style']['opacity'] = '1';
    }, 0x12c);
}
function lol() {
    const _0x552ff3 = _0x2f771a;
    document[_0x552ff3(0x218)]('.message.self\x20.read-receipt')[_0x552ff3(0x1d9)](_0x468970 => {
        const _0x408513 = _0x552ff3;
        _0x468970[_0x408513(0x12c)] === '✔' && (_0x468970[_0x408513(0x12c)] = '✔✔');
    });
}
function setViewportHeight() {
    const _0x346bda = _0x2f771a;
    document[_0x346bda(0x21a)][_0x346bda(0x1e0)][_0x346bda(0x203)](_0x346bda(0x18b), window['innerHeight'] * 0.01 + 'px');
}
window[_0x2f771a(0xe4)]('resize', setViewportHeight), setViewportHeight();
function showChatPanel() {
    const _0x558ad0 = _0x2f771a;
    document[_0x558ad0(0x224)](_0x558ad0(0x1b8))[_0x558ad0(0x1d1)]['add'](_0x558ad0(0xf2));
}
function showUserListPanel() {
    const _0x59f9d2 = _0x2f771a;
    document[_0x59f9d2(0x224)](_0x59f9d2(0x1b8))[_0x59f9d2(0x1d1)]['remove'](_0x59f9d2(0xf2));
}
document[_0x2f771a(0x224)](_0x2f771a(0x10a))[_0x2f771a(0xe4)]('click', _0x26469b => {
    const _0x1f2cf4 = _0x2f771a;
    window[_0x1f2cf4(0x1b3)] <= 0x300 && showChatPanel();
}), document[_0x2f771a(0x224)](_0x2f771a(0x193))[_0x2f771a(0xe4)](_0x2f771a(0x1c3), _0x228891 => {
    window['innerWidth'] <= 0x300 && showUserListPanel();
});
const savedImage = localStorage[_0x2f771a(0x1c4)](_0x2f771a(0x149));
function _0x29ec(_0x52526e, _0x1093b1) {
    const _0x2a5d34 = _0x2a5d();
    return _0x29ec = function (_0x29ec63, _0x4a0363) {
        _0x29ec63 = _0x29ec63 - 0xd9;
        let _0x9637a4 = _0x2a5d34[_0x29ec63];
        if (_0x29ec['NWfDIz'] === undefined) {
            var _0x4d220a = function (_0x4929a0) {
                const _0x359444 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';
                let _0x5d7f29 = '', _0x2a5575 = '';
                for (let _0x1de5e1 = 0x0, _0x14e97d, _0x4f10df, _0x16fca6 = 0x0; _0x4f10df = _0x4929a0['charAt'](_0x16fca6++); ~_0x4f10df && (_0x14e97d = _0x1de5e1 % 0x4 ? _0x14e97d * 0x40 + _0x4f10df : _0x4f10df, _0x1de5e1++ % 0x4) ? _0x5d7f29 += String['fromCharCode'](0xff & _0x14e97d >> (-0x2 * _0x1de5e1 & 0x6)) : 0x0) {
                    _0x4f10df = _0x359444['indexOf'](_0x4f10df);
                }
                for (let _0x9628a3 = 0x0, _0x4f1ec0 = _0x5d7f29['length']; _0x9628a3 < _0x4f1ec0; _0x9628a3++) {
                    _0x2a5575 += '%' + ('00' + _0x5d7f29['charCodeAt'](_0x9628a3)['toString'](0x10))['slice'](-0x2);
                }
                return decodeURIComponent(_0x2a5575);
            };
            _0x29ec['SrDaKI'] = _0x4d220a, _0x52526e = arguments, _0x29ec['NWfDIz'] = !![];
        }
        const _0x34d50b = _0x2a5d34[0x0], _0xac9a00 = _0x29ec63 + _0x34d50b, _0x2045c9 = _0x52526e[_0xac9a00];
        return !_0x2045c9 ? (_0x9637a4 = _0x29ec['SrDaKI'](_0x9637a4), _0x52526e[_0xac9a00] = _0x9637a4) : _0x9637a4 = _0x2045c9, _0x9637a4;
    }, _0x29ec(_0x52526e, _0x1093b1);
}
document[_0x2f771a(0x1e2)](_0x2f771a(0x179))[_0x2f771a(0x20c)] = savedImage || _0x2f771a(0x188);
function showNotification(_0x1a9a3a) {
    const _0x34b22a = _0x2f771a, _0x53f2fd = document[_0x34b22a(0x1dc)]('div');
    _0x53f2fd[_0x34b22a(0x12c)] = _0x1a9a3a, _0x53f2fd[_0x34b22a(0x1e0)][_0x34b22a(0x15f)] = _0x34b22a(0x16b), document[_0x34b22a(0x213)]['appendChild'](_0x53f2fd), setTimeout(() => _0x53f2fd[_0x34b22a(0x1e8)](), 0xbb8);
}
async function generateKey() {
    const _0x2edefe = _0x2f771a;
    if (sessionStorage['getItem']('encryptionKey'))
        return;
    const _0x239327 = await crypto['subtle'][_0x2edefe(0x125)]({
            'name': 'AES-GCM',
            'length': 0x100
        }, !![], [
            'encrypt',
            _0x2edefe(0x21e)
        ]), _0x591bdd = new Uint8Array(await crypto[_0x2edefe(0x1f2)][_0x2edefe(0x1da)](_0x2edefe(0x16a), _0x239327));
    sessionStorage[_0x2edefe(0x1c5)](_0x2edefe(0x205), JSON[_0x2edefe(0x153)](Array[_0x2edefe(0x11a)](_0x591bdd)));
}
generateKey();
async function getKey() {
    const _0x2893b7 = _0x2f771a, _0xc64701 = JSON[_0x2893b7(0x1e4)](sessionStorage['getItem']('encryptionKey')), _0xb80be2 = new Uint8Array(_0xc64701);
    return await crypto[_0x2893b7(0x1f2)][_0x2893b7(0x19d)](_0x2893b7(0x16a), _0xb80be2, { 'name': _0x2893b7(0x1c2) }, !![], [
        _0x2893b7(0x145),
        _0x2893b7(0x21e)
    ]);
}
async function encryptMessage(_0x3f0de6) {
    const _0x21dd27 = _0x2f771a, _0x1245db = await getKey(), _0x324b51 = crypto[_0x21dd27(0xe1)](new Uint8Array(0xc)), _0x564017 = new TextEncoder()[_0x21dd27(0x21d)](_0x3f0de6), _0x40ca7f = await crypto[_0x21dd27(0x1f2)]['encrypt']({
            'name': _0x21dd27(0x1c2),
            'iv': _0x324b51
        }, _0x1245db, _0x564017);
    return JSON[_0x21dd27(0x153)]({
        'iv': Array[_0x21dd27(0x11a)](_0x324b51),
        'data': Array[_0x21dd27(0x11a)](new Uint8Array(_0x40ca7f))
    });
}
async function decryptMessage(_0x40bf43) {
    const _0x5b4378 = _0x2f771a;
    try {
        const _0x5cbd99 = await getKey(), _0x513fcb = JSON['parse'](_0x40bf43), _0x699cf3 = new Uint8Array(_0x513fcb['iv']), _0x24983e = new Uint8Array(_0x513fcb[_0x5b4378(0x166)]), _0x41ab61 = await crypto['subtle'][_0x5b4378(0x21e)]({
                'name': _0x5b4378(0x1c2),
                'iv': _0x699cf3
            }, _0x5cbd99, _0x24983e);
        return new TextDecoder()[_0x5b4378(0x106)](_0x41ab61);
    } catch (_0x4dd556) {
        return console[_0x5b4378(0x1a5)](_0x5b4378(0x15d), _0x4dd556), null;
    }
}
async function loadChatCache() {
    const _0x363269 = _0x2f771a;
    showNotification(_0x363269(0x10c));
    let _0x497a26 = ![];
    for (let _0x109c81 = 0x0; _0x109c81 < localStorage[_0x363269(0x1ee)]; _0x109c81++) {
        const _0x30861d = localStorage['key'](_0x109c81);
        if (_0x30861d[_0x363269(0xde)](_0x363269(0x20b))) {
            const _0x18c5fc = _0x30861d[_0x363269(0xfd)]('_')[0x1], _0x471efc = localStorage['getItem'](_0x30861d);
            if (_0x471efc)
                try {
                    const _0x2102f4 = await Promise[_0x363269(0x1cb)](JSON[_0x363269(0x1e4)](_0x471efc)[_0x363269(0x215)](async _0x35128d => {
                        const _0x27cc44 = _0x363269, _0x188764 = await decryptMessage(_0x35128d);
                        if (_0x188764 === null)
                            throw new Error(_0x27cc44(0x142));
                        return JSON[_0x27cc44(0x1e4)](_0x188764);
                    }));
                    chatCache[_0x363269(0x120)](_0x18c5fc, _0x2102f4);
                } catch (_0xa50838) {
                    console[_0x363269(0x1a5)](_0x363269(0x1d6) + _0x18c5fc + ':', _0xa50838), localStorage[_0x363269(0x1f1)](_0x30861d), console[_0x363269(0x171)]('Removed\x20corrupted\x20chat\x20cache\x20for\x20user\x20' + _0x18c5fc), _0x497a26 = !![];
                }
        }
    }
    _0x497a26 ? showNotification('⚠️\x20Some\x20chats\x20failed\x20to\x20load\x20due\x20to\x20decryption\x20errors.') : showNotification(_0x363269(0x157));
}
window[_0x2f771a(0xe4)](_0x2f771a(0x22a), loadChatCache), document[_0x2f771a(0xe4)](_0x2f771a(0x131), () => {
    const _0x63b997 = _0x2f771a, _0x2a0365 = document[_0x63b997(0x1e2)](_0x63b997(0xee)), _0x4a0dfe = document['getElementById'](_0x63b997(0x1cc)), _0x4d9817 = document[_0x63b997(0x1e2)](_0x63b997(0x1a2)), _0x3cbf8c = new EmojiMart[(_0x63b997(0x12b))]({
            'onEmojiSelect': _0x256f23 => {
                _0x4a0dfe['value'] += _0x256f23['native'];
            },
            'theme': _0x63b997(0xe2)
        });
    _0x4d9817[_0x63b997(0x112)](_0x3cbf8c), _0x2a0365[_0x63b997(0xe4)](_0x63b997(0x1c3), () => {
        const _0xf3ef5 = _0x63b997;
        _0x4d9817[_0xf3ef5(0x1d1)][_0xf3ef5(0x1bb)](_0xf3ef5(0x1e5));
    }), document[_0x63b997(0xe4)](_0x63b997(0x1c3), _0x5d905f => {
        const _0x5b8179 = _0x63b997;
        !_0x4d9817[_0x5b8179(0x1c8)](_0x5d905f[_0x5b8179(0x1fd)]) && _0x5d905f[_0x5b8179(0x1fd)] !== _0x2a0365 && _0x4d9817['classList']['add'](_0x5b8179(0x1e5));
    });
}), document[_0x2f771a(0x1e2)](_0x2f771a(0x175))['onclick'] = function () {
    const _0x1403cb = _0x2f771a;
    document[_0x1403cb(0x1e2)]('wallpaperModal')[_0x1403cb(0x1e0)][_0x1403cb(0x1b9)] = _0x1403cb(0x12e);
};
function closeModal() {
    const _0x5189d2 = _0x2f771a;
    document['getElementById'](_0x5189d2(0x160))[_0x5189d2(0x1e0)][_0x5189d2(0x1b9)] = _0x5189d2(0x104);
}
function setChatBackground(_0x123385) {
    const _0x5b306f = _0x2f771a, _0x11139b = document[_0x5b306f(0x224)]('.chat-window');
    _0x11139b['style'][_0x5b306f(0x172)] = _0x123385, _0x11139b[_0x5b306f(0x1e0)][_0x5b306f(0x185)] = 'cover', _0x11139b[_0x5b306f(0x1e0)]['backgroundPosition'] = _0x5b306f(0x15c), localStorage[_0x5b306f(0x1c5)](_0x5b306f(0x146), _0x123385), closeModal();
}
function resetChatBackground() {
    const _0x513c43 = _0x2f771a;
    document['querySelector'](_0x513c43(0x1ab))[_0x513c43(0x1e0)]['background'] = '', localStorage[_0x513c43(0x1f1)](_0x513c43(0x146)), closeModal();
}
window['onload'] = function () {
    const _0x23948e = _0x2f771a;
    let _0x34c468 = localStorage[_0x23948e(0x1c4)](_0x23948e(0x146));
    if (_0x34c468) {
        let _0x4612eb = document[_0x23948e(0x224)](_0x23948e(0x1ab));
        _0x4612eb[_0x23948e(0x1e0)][_0x23948e(0x176)] = _0x34c468, _0x4612eb[_0x23948e(0x1e0)][_0x23948e(0x185)] = _0x23948e(0x130), _0x4612eb[_0x23948e(0x1e0)][_0x23948e(0x1f6)] = _0x23948e(0x15c);
    }
}, document['addEventListener'](_0x2f771a(0x131), function () {
    const _0x2e74a2 = _0x2f771a, _0x1122c7 = document['getElementById'](_0x2e74a2(0x1d7)), _0x442ad6 = document[_0x2e74a2(0x1e2)](_0x2e74a2(0x191)), _0x1aea99 = document[_0x2e74a2(0x1e2)](_0x2e74a2(0x201)), _0x3c8d7e = document[_0x2e74a2(0x1e2)]('blur-value'), _0x4d4fa2 = document[_0x2e74a2(0x1e2)](_0x2e74a2(0x228));
    let _0x1df627 = localStorage[_0x2e74a2(0x1c4)](_0x2e74a2(0x21c)) || 0x5;
    document[_0x2e74a2(0x21a)]['style'][_0x2e74a2(0x203)]('--blur-value', _0x1df627 + 'px'), _0x1aea99['value'] = _0x1df627, _0x3c8d7e[_0x2e74a2(0x12c)] = _0x1df627, _0x1122c7[_0x2e74a2(0xe4)]('click', function () {
        const _0x1f687f = _0x2e74a2;
        _0x442ad6['style']['display'] = _0x1f687f(0x12e);
    }), _0x1aea99[_0x2e74a2(0xe4)](_0x2e74a2(0x121), function () {
        const _0x36cfc6 = _0x2e74a2;
        document['documentElement'][_0x36cfc6(0x1e0)]['setProperty'](_0x36cfc6(0x182), this[_0x36cfc6(0x214)] + 'px'), _0x3c8d7e['textContent'] = this['value'], localStorage[_0x36cfc6(0x1c5)]('chatBlur', this[_0x36cfc6(0x214)]);
    }), _0x4d4fa2[_0x2e74a2(0xe4)](_0x2e74a2(0x1c3), function () {
        const _0x17db7a = _0x2e74a2;
        _0x442ad6[_0x17db7a(0x1e0)][_0x17db7a(0x1b9)] = _0x17db7a(0x104);
    });
});
function clearChatCacheCnf(_0x39e1e5, _0xc88a06) {
    const _0x153a5f = _0x2f771a;
    if (!confirm(_0x153a5f(0x107) + currentChatUsername + '?'))
        return;
    clearChatCache(_0x39e1e5, _0xc88a06);
}
function clearChatCache(_0x1aaad2, _0xae8251) {
    const _0x263471 = _0x2f771a;
    chatCache[_0x263471(0x1aa)](_0x1aaad2) && chatCache[_0x263471(0x222)](_0x1aaad2);
    const _0x3cb188 = _0x263471(0x20b) + _0x1aaad2;
    localStorage[_0x263471(0x1c4)](_0x3cb188) && localStorage['removeItem'](_0x3cb188);
    const _0x31430f = document[_0x263471(0x1e2)](_0x263471(0x1dd));
    currentChatUsername === _0xae8251 && (_0x31430f[_0x263471(0x1e0)][_0x263471(0xe8)] = _0x263471(0x14b), _0x31430f[_0x263471(0x1e0)][_0x263471(0x1bd)] = '0', _0x31430f[_0x263471(0x1e0)]['transform'] = _0x263471(0xf4), setTimeout(() => {
        const _0x3d7bc5 = _0x263471;
        _0x31430f['innerHTML'] = '', _0x31430f[_0x3d7bc5(0x1e0)][_0x3d7bc5(0x1bd)] = '1', _0x31430f['style'][_0x3d7bc5(0x187)] = 'translateY(0)';
    }, 0x190)), showPopupMessage(_0x263471(0x1ac) + _0xae8251);
}
async function deleteChatHistory(_0x14ab35) {
    const _0x47f593 = _0x2f771a;
    if (!_0x14ab35) {
        showPopupMessage2(_0x47f593(0xf9));
        return;
    }
    const _0x191726 = confirm(_0x47f593(0x178));
    if (!_0x191726)
        return;
    try {
        showPopupMessage2(_0x47f593(0x162), 0x2710, _0x47f593(0x1bc));
        const _0x285a7e = await apiRequest(_0x47f593(0x144) + senderUserId + '/' + _0x14ab35, {
                'method': _0x47f593(0x1f7),
                'headers': {
                    'Content-Type': _0x47f593(0xfb),
                    'Authorization': _0x47f593(0x111) + localStorage[_0x47f593(0x1c4)](_0x47f593(0x10b))
                }
            }), _0x8c696c = await _0x285a7e[_0x47f593(0x217)]();
        if (_0x285a7e['ok']) {
            console['log'](_0x47f593(0x102), _0x8c696c), showPopupMessage2(_0x47f593(0x148), 0xbb8, _0x47f593(0x13a));
            let _0x1c29bb = JSON[_0x47f593(0x1e4)](localStorage[_0x47f593(0x1c4)](_0x47f593(0x200))) || [];
            _0x1c29bb = _0x1c29bb[_0x47f593(0x11c)](_0x1645fc => _0x1645fc[_0x47f593(0x132)] !== _0x14ab35), localStorage[_0x47f593(0x1c5)]('chattedUsers', JSON[_0x47f593(0x153)](_0x1c29bb)), clearChatCache(currentChatUserId, currentChatUsername);
            const _0x482523 = document[_0x47f593(0x1e2)](_0x47f593(0x1dd));
            loadChatList(), socket[_0x47f593(0x221)]('chatDeleted', {
                'senderUsername': senderUsername,
                'chatUserId': _0x14ab35
            });
        } else
            console[_0x47f593(0x1a5)](_0x47f593(0x198), _0x8c696c['error']), alert(_0x47f593(0x180) + _0x8c696c['error']);
    } catch (_0x5ab1cf) {
        showPopupMessage2('Failed\x20to\x20delete\x20chat\x20history.\x20Please\x20try\x20again.', 0x1388), console[_0x47f593(0x1a5)](_0x47f593(0x15e), _0x5ab1cf);
    }
}
socket['on'](_0x2f771a(0x183), ({
    senderUserId: _0x4c3cca,
    senderUsername: _0x1bc005
}) => {
    const _0xe946dc = _0x2f771a;
    clearChatCache(_0x4c3cca, _0x1bc005), console[_0xe946dc(0x19a)](_0xe946dc(0x10e) + _0x4c3cca + _0xe946dc(0x20d)), showPopupMessage2('Chat\x20history\x20with\x20' + _0x1bc005 + _0xe946dc(0x20d), 0x1388);
}), intializeSocket(), socket['on'](_0x2f771a(0x1a5), _0x151e11 => {
    const _0x4c8d9a = _0x2f771a;
    console[_0x4c8d9a(0x1a5)]('🔴\x20Socket\x20Error:', _0x151e11), showAlert('Socket\x20Error!', _0x151e11['message'] || _0x4c8d9a(0xf0));
});